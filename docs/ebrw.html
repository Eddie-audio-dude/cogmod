<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>9&nbsp; Exemplar of the Exemplar Based Random Walk – Computational Cognitive Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./vector_reps.html" rel="next">
<link href="./accumulator_models.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ebrw.html">Coupling behavior to structured representations</a></li><li class="breadcrumb-item"><a href="./ebrw.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exemplar of the Exemplar Based Random Walk</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computational Cognitive Models</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Background</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Programming with R</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Modeling behavior</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random_walk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Building a random walk model to simulate choice and RT</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diffusion_sim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">From random walk to diffusion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diffusion_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fitting a diffusion model to data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model complexity and model comparison</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blast_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">A worked example</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accumulator_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Accumulator models of choice and response time</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Coupling behavior to structured representations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ebrw.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exemplar of the Exemplar Based Random Walk</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vector_reps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Distributed representations, similarity, and recognition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Associative Learning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summed-similarity" id="toc-summed-similarity" class="nav-link active" data-scroll-target="#summed-similarity"><span class="header-section-number">9.1</span> Summed similarity</a>
  <ul class="collapse">
  <li><a href="#perceived-distance-and-similarity" id="toc-perceived-distance-and-similarity" class="nav-link" data-scroll-target="#perceived-distance-and-similarity"><span class="header-section-number">9.1.1</span> Perceived distance and similarity</a></li>
  <li><a href="#summed-similarity-1" id="toc-summed-similarity-1" class="nav-link" data-scroll-target="#summed-similarity-1"><span class="header-section-number">9.1.2</span> Summed similarity</a></li>
  </ul></li>
  <li><a href="#making-a-recognition-decision-from-random-walk-to-diffusion" id="toc-making-a-recognition-decision-from-random-walk-to-diffusion" class="nav-link" data-scroll-target="#making-a-recognition-decision-from-random-walk-to-diffusion"><span class="header-section-number">9.2</span> Making a recognition decision: From random walk to diffusion</a>
  <ul class="collapse">
  <li><a href="#accumulating-memory-evidence" id="toc-accumulating-memory-evidence" class="nav-link" data-scroll-target="#accumulating-memory-evidence"><span class="header-section-number">9.2.1</span> Accumulating memory evidence</a></li>
  <li><a href="#step-probabilities" id="toc-step-probabilities" class="nav-link" data-scroll-target="#step-probabilities"><span class="header-section-number">9.2.2</span> Step probabilities</a></li>
  <li><a href="#from-discrete-random-walk-to-continuous-diffusion" id="toc-from-discrete-random-walk-to-continuous-diffusion" class="nav-link" data-scroll-target="#from-discrete-random-walk-to-continuous-diffusion"><span class="header-section-number">9.2.3</span> From discrete random walk to continuous diffusion</a></li>
  </ul></li>
  <li><a href="#implementation-in-r" id="toc-implementation-in-r" class="nav-link" data-scroll-target="#implementation-in-r"><span class="header-section-number">9.3</span> Implementation in R</a>
  <ul class="collapse">
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters"><span class="header-section-number">9.3.1</span> Parameters</a></li>
  <li><a href="#computing-the-mean-and-sd-of-the-drift-for-each-trial" id="toc-computing-the-mean-and-sd-of-the-drift-for-each-trial" class="nav-link" data-scroll-target="#computing-the-mean-and-sd-of-the-drift-for-each-trial"><span class="header-section-number">9.3.2</span> Computing the mean and SD of the drift for each trial</a></li>
  <li><a href="#calculating-the-log-likelihood" id="toc-calculating-the-log-likelihood" class="nav-link" data-scroll-target="#calculating-the-log-likelihood"><span class="header-section-number">9.3.3</span> Calculating the log-likelihood</a></li>
  <li><a href="#error-checking" id="toc-error-checking" class="nav-link" data-scroll-target="#error-checking"><span class="header-section-number">9.3.4</span> Error-checking</a></li>
  </ul></li>
  <li><a href="#a-worked-example" id="toc-a-worked-example" class="nav-link" data-scroll-target="#a-worked-example"><span class="header-section-number">9.4</span> A worked example</a>
  <ul class="collapse">
  <li><a href="#check-out-the-data" id="toc-check-out-the-data" class="nav-link" data-scroll-target="#check-out-the-data"><span class="header-section-number">9.4.1</span> Check out the data</a></li>
  <li><a href="#finding-optimal-parameters" id="toc-finding-optimal-parameters" class="nav-link" data-scroll-target="#finding-optimal-parameters"><span class="header-section-number">9.4.2</span> Finding optimal parameters</a></li>
  </ul></li>
  <li><a href="#predictions-by-simulation-and-math" id="toc-predictions-by-simulation-and-math" class="nav-link" data-scroll-target="#predictions-by-simulation-and-math"><span class="header-section-number">9.5</span> Predictions by simulation and math</a>
  <ul class="collapse">
  <li><a href="#simulating-individual-trials" id="toc-simulating-individual-trials" class="nav-link" data-scroll-target="#simulating-individual-trials"><span class="header-section-number">9.5.1</span> Simulating individual trials</a></li>
  <li><a href="#mathematical-expressions-for-response-probability-and-mean-rts" id="toc-mathematical-expressions-for-response-probability-and-mean-rts" class="nav-link" data-scroll-target="#mathematical-expressions-for-response-probability-and-mean-rts"><span class="header-section-number">9.5.2</span> Mathematical expressions for response probability and mean RT’s</a></li>
  <li><a href="#comparing-predicted-to-observed" id="toc-comparing-predicted-to-observed" class="nav-link" data-scroll-target="#comparing-predicted-to-observed"><span class="header-section-number">9.5.3</span> Comparing predicted to observed</a></li>
  <li><a href="#making-novel-predictions" id="toc-making-novel-predictions" class="nav-link" data-scroll-target="#making-novel-predictions"><span class="header-section-number">9.5.4</span> Making novel predictions</a></li>
  </ul></li>
  <li><a href="#putting-it-all-together" id="toc-putting-it-all-together" class="nav-link" data-scroll-target="#putting-it-all-together"><span class="header-section-number">9.6</span> Putting it all together</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">9.7</span> Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ebrw.html">Coupling behavior to structured representations</a></li><li class="breadcrumb-item"><a href="./ebrw.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exemplar of the Exemplar Based Random Walk</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exemplar of the Exemplar Based Random Walk</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>So far, we have focused on models that explain behavior (choice and response time) in terms of how representations of “evidence” are processed via some form of accumulation. We pointed out that the “evidence” in these models was an abstract quantity that would be interpreted differently depending on the application—the “evidence” for Buridan’s Ass was largely perceptual in nature, based on the visual features of his two hay piles; the “evidence” in a recognition memory task came from processes that compared a probe item to the contents of memory; the “evidence” in a visual search task cam from processes that compared the items in the display to a representation of the search target. In this chapter, we begin to dig deeper by explaining where this evidence comes from in a particular task domain. Specifically, we will explore the <strong>Exemplar-Based Random Walk (EBRW)</strong> model <span class="citation" data-cites="NosofskyPalmeri1997 NosofskyEtAl2011">(<a href="references.html#ref-NosofskyEtAl2011" role="doc-biblioref">Nosofsky et al., 2011</a>; <a href="references.html#ref-NosofskyPalmeri1997" role="doc-biblioref">Nosofsky &amp; Palmeri, 1997</a>)</span>. We will see how this model explains choice and response time in a recognition memory task by explaining <em>how</em> the relevant evidence is derived.</p>
<p>The EBRW is a dynamic extension of the earlier <strong>Generalized Context Model (GCM)</strong> <span class="citation" data-cites="Nosofsky1986">(<a href="references.html#ref-Nosofsky1986" role="doc-biblioref">Nosofsky, 1986</a>)</span>. According to both tbe EBRW and GCM, each time you experience an item in a particular context, it leaves a “trace” in memory. This trace is called an “exemplar” or an “instance” and it consists of a record of the <strong>values</strong> the item had for particular <strong>features</strong> or <strong>attributes</strong>. When you are presented with a <strong>probe</strong> item, it <em>activates</em> each of these exemplars in memory in proportion to how <em>similar</em> the features of the probe are to the features of the exemplars in memory.</p>
<p>The EBRW was originally developed to account for choice and RT in <em>categorization</em> tasks. In what follows, we apply EBRW to a <em>recognition</em> task. Recognition decisions are based on the summed activation across all exemplars in memory, which is termed the “familiarity” of the probe. The extent to which familiarity is higher than a <strong>criterion</strong> determines the extent to which the probe will be recognized as having been seen before. Specifically, familiarity determines the <strong>rate at which evidence accumulates</strong> toward either a “yes” or “no” decision regarding whether the probe item was seen before. If the accumulated evidence reaches an upper threshold, a “yes” decision is made; otherwise, if the accumulated evidence reaches a lower threshold, a “no” decision is made.</p>
<p>The text below first describes how familiarity is determined by the summed similarity between a probe and the exemplars in memory, using the concrete example of items consisting of patches of color. Then, the dynamics of evidence accumulation are described. These dynamics are first described as a random walk between the thresholds for “yes” and “no” decisions. Then, we illustrate how the same dynamics can be described in continuous time as a diffusion process instead of a random walk <span class="citation" data-cites="NosofskyEtAl2014">(<a href="references.html#ref-NosofskyEtAl2014" role="doc-biblioref">Nosofsky et al., 2014</a>)</span>. Finally, we see how the continuous diffusion process makes it easier to fit the parameters of the EBRW model to recognition data.</p>
<section id="summed-similarity" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="summed-similarity"><span class="header-section-number">9.1</span> Summed similarity</h2>
<p>For concreteness, we imagine an experiment in which several color patches were studied. Colors can be described in terms of three features: <em>hue</em>, <em>chroma</em> (or “saturation”), and <em>luminance</em> (or “brightness”). Imagine that you saw many reddish-hued colors that varied in chroma and luminance. According to the EBRW, each of the colors you saw would leave a trace in memory. Each trace would consist of the values of the color you saw along those three dimensions. In this example, all the colors have the same value for “hue”, which is 0. The value of “0” for “hue” corresponds to a reddish color. The colors differ in their values for chroma and luminance, as illustrated in the graph below:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>colDF <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">h =</span> hue, <span class="at">c =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">70</span>, <span class="at">length.out =</span> <span class="dv">5</span>), <span class="at">l =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">70</span>, <span class="at">length.out =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">hcl</span>(h, c, l))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>colDF <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> c, <span class="at">y =</span> l, <span class="at">fill =</span> col)) <span class="sc">+</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">width =</span> <span class="fl">2.5</span>, <span class="at">height =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chroma (saturation)"</span>, <span class="at">y =</span> <span class="st">"Luminance (brightness)"</span>, <span class="at">caption =</span> <span class="fu">bquote</span>(<span class="fu">plain</span>(hue) <span class="sc">==</span> .(<span class="fu">round</span>(hue))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ebrw_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Your memory traces can also be written as a matrix, where each row corresponds to an item (color) and each column corresponds to a feature (<strong>h</strong> for “hue”, <strong>c</strong> for “chroma”, and <strong>l</strong> for “luminance”):</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(colDF <span class="sc">%&gt;%</span> <span class="fu">select</span>(h, c, l), <span class="dv">10</span>), <span class="at">row.names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">h</th>
<th style="text-align: right;">c</th>
<th style="text-align: right;">l</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">70</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">70</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>These coordinates will often be derived using <strong>Multidimensional Scaling (MDS)</strong> <span class="citation" data-cites="Shepard1962a Shepard1962b Nosofsky1992">(<a href="references.html#ref-Nosofsky1992" role="doc-biblioref">Nosofsky, 1992</a>; <a href="references.html#ref-Shepard1962a" role="doc-biblioref">Shepard, 1962a</a>, <a href="references.html#ref-Shepard1962b" role="doc-biblioref">1962b</a>)</span>. This type of analysis derives a spatial representation of a set of stimuli on the basis of similarity judgments provided by raters.</p>
<section id="perceived-distance-and-similarity" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="perceived-distance-and-similarity"><span class="header-section-number">9.1.1</span> Perceived distance and similarity</h3>
<p>The perceived <strong>distance</strong> between any two of these colors is the Euclidean distance between their feature values, weighted by the degree of attention given to each feature: <span class="math display">\[
d_{ij} = \sqrt{\sum_{k = 1}^{N_F} w_k \left(x_{ik} - x_{jk} \right)^2}
\]</span> where <span class="math inline">\(w_k\)</span> is the weight given to feature <span class="math inline">\(k\)</span>, <span class="math inline">\(x_{ik}\)</span> is the value of item <span class="math inline">\(i\)</span> on feature <span class="math inline">\(k\)</span>, <span class="math inline">\(x_{jk}\)</span> is the value of item <span class="math inline">\(j\)</span> on feature <span class="math inline">\(k\)</span>, <span class="math inline">\(d_{ij}\)</span> is the perceived distance between items <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, and <span class="math inline">\(N_F\)</span> is the number of features which in this example is 3 (hue, chroma, and luminance). Note also that while Euclidean distance is appropriate for colors, other types of distance metrics may be more appropriate for other kinds of stimuli, particularly those with <em>separable</em> dimensions which are perceived independently from one another <span class="citation" data-cites="GarnerFelfoldy1970">(e.g., <a href="references.html#ref-GarnerFelfoldy1970" role="doc-biblioref">Garner &amp; Felfoldy, 1970</a>)</span>.</p>
<p>Perceived <strong>similarity</strong> between two items, <span class="math inline">\(s_{ij}\)</span>, is an exponential function of the psychological distance between those items: <span class="math display">\[
s_{ij} = \exp(-c d_{ij})
\]</span> where <span class="math inline">\(c\)</span> is a <em>sensitivity</em> parameter that controls how quickly perceived similarity decreases with distance, as illustrated in the graph below:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expand_grid</span>(<span class="at">d =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">151</span>), <span class="at">c =</span> <span class="fu">seq</span>(<span class="fl">0.25</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.25</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">s =</span> <span class="fu">exp</span>(<span class="sc">-</span>c <span class="sc">*</span> d)) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> s, <span class="at">color =</span> c, <span class="at">group =</span> c)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous_sequential</span>() <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(d[ij]), <span class="at">y =</span> <span class="fu">expression</span>(s[ij])) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"inside"</span>, <span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ebrw_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summed-similarity-1" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="summed-similarity-1"><span class="header-section-number">9.1.2</span> Summed similarity</h3>
<p>Imagine that you have just been shown two colors from among the set shown earlier. We then present you with a third color—a <strong>probe item</strong>—and ask whether it was one of the two you just saw. You answer this question on the basis of the <em>summed similarity</em> between the probe item and the two items in memory. The probe item has its own vector of feature values, <span class="math inline">\(\mathbf{x_q}\)</span>. The perceived distance between the probe item and <em>each</em> of the memory items is, as above, the Euclidean distance between the probe’s feature values and those of the memory item: <span class="math display">\[
\begin{align}
d_{qj} &amp; = \sqrt{\sum_{k = 1}^{N_F} w_k \left(x_{qk} - x_{jk} \right)^2} \\
s_{qj} &amp; = \exp \left( -c d_{qj} \right) \\
S &amp; = \sum_{j = 1}^{N_M} s_{qj}
\end{align}
\]</span> and, again, the perceived similarity <span class="math inline">\(s_{qj}\)</span> between the probe <span class="math inline">\(q\)</span> and memory item <span class="math inline">\(j\)</span> is an exponential function of perceived distance <span class="math inline">\(d_{qj}\)</span>. Finally, summed similarity <span class="math inline">\(S\)</span> is the sum of the perceived similarities across all <span class="math inline">\(N_M\)</span> items in memory.</p>
<p>The graphs below illustrate how this works. The left graph shows contours of equal similarity from each of two study items. The right graph shows summed similarity as a function of the chroma and luminance of a probe item (assuming the same hue).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">60</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>      <span class="dv">60</span>, <span class="dv">50</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>sens <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>colDF <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">h =</span> hue, <span class="at">c =</span> X[,<span class="dv">1</span>], <span class="at">l =</span> X[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">hcl</span>(h, c, l))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>item_cols <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(colDF<span class="sc">$</span>col)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(item_cols) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(item_cols))</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>simDF <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">c =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">70</span>, <span class="at">length.out=</span><span class="dv">101</span>), <span class="at">l =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">70</span>, <span class="at">length.out=</span><span class="dv">101</span>), <span class="at">item =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">sqrt</span>((c <span class="sc">-</span> X[item, <span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (l <span class="sc">-</span> X[item, <span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">s =</span> <span class="fu">exp</span>(<span class="sc">-</span>sens <span class="sc">*</span> d))</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>conPlot <span class="ot">&lt;-</span> colDF <span class="sc">%&gt;%</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> c, <span class="at">y =</span> l)) <span class="sc">+</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> s, <span class="at">color =</span> <span class="fu">factor</span>(item)), <span class="at">data =</span> simDF, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> col), <span class="at">width =</span> <span class="fl">2.5</span>, <span class="at">height =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_identity</span>(<span class="at">aesthetics =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> item_cols, <span class="at">aesthetics =</span> <span class="st">"color"</span>, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>)) <span class="sc">+</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chroma (saturation)"</span>, <span class="at">y =</span> <span class="st">"Luminance (brightness)"</span>, <span class="at">subtitle =</span> <span class="st">"Contours of equal similarity"</span>, <span class="at">caption =</span> <span class="fu">bquote</span>(<span class="fu">list</span>(<span class="fu">plain</span>(hue) <span class="sc">==</span> .(<span class="fu">round</span>(hue)), c <span class="sc">==</span> .(<span class="fu">signif</span>(sens, <span class="dv">3</span>)))))</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>sumSimPlot <span class="ot">&lt;-</span> simDF <span class="sc">%&gt;%</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(c, l) <span class="sc">%&gt;%</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">summed_sim =</span> <span class="fu">sum</span>(s), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> c, <span class="at">y =</span> l, <span class="at">fill =</span> summed_sim)) <span class="sc">+</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"magma"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>)) <span class="sc">+</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chroma (saturation)"</span>, <span class="at">y =</span> <span class="st">"Luminance (brightness)"</span>, <span class="at">subtitle =</span> <span class="st">"Summed similarity"</span>, <span class="at">caption =</span> <span class="fu">bquote</span>(<span class="fu">list</span>(<span class="fu">plain</span>(hue) <span class="sc">==</span> .(<span class="fu">round</span>(hue)), c <span class="sc">==</span> .(<span class="fu">signif</span>(sens, <span class="dv">3</span>)))))</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>conPlot <span class="sc">+</span> sumSimPlot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ebrw_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="trace-strength" class="level4" data-number="9.1.2.1">
<h4 data-number="9.1.2.1" class="anchored" data-anchor-id="trace-strength"><span class="header-section-number">9.1.2.1</span> Trace strength</h4>
<p>It is reasonable to believe that some memory traces are <em>stronger</em> than others, likely due to things like primacy and recency. In GCM/EBRW, “strength” is operationalized as a scaling factor <span class="math inline">\(m_j\)</span> applied to perceived similarity: <span class="math display">\[
s_{qj} = m_j \exp \left( -c d_{qj} \right)
\]</span></p>
<p>Stronger traces have their similarity multiplied by a large value (<span class="math inline">\(m_j\)</span> is large if trace <span class="math inline">\(j\)</span> is strong) while weaker traces have their similarity multiplied by a small value (<span class="math inline">\(m_j\)</span> is small if trace <span class="math inline">\(j\)</span> is weak). This is illustrated in the pair of graphs below. A probe item does not need to be as similar to a strong item in order to evoke the same level of perceived similarity.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">60</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>      <span class="dv">60</span>, <span class="dv">50</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>sens <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>strength <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>colDF <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">h =</span> hue, <span class="at">c =</span> X[,<span class="dv">1</span>], <span class="at">l =</span> X[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">hcl</span>(h, c, l)) <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>item_cols <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(colDF<span class="sc">$</span>col)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(item_cols) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(item_cols))</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>simDF <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">c =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">70</span>, <span class="at">length.out=</span><span class="dv">101</span>), <span class="at">l =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">70</span>, <span class="at">length.out=</span><span class="dv">101</span>), <span class="at">item =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">sqrt</span>((c <span class="sc">-</span> X[item, <span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (l <span class="sc">-</span> X[item, <span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">s =</span> <span class="fu">exp</span>(<span class="sc">-</span>sens <span class="sc">*</span> d) <span class="sc">*</span> strength[item])</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>conPlot <span class="ot">&lt;-</span> colDF <span class="sc">%&gt;%</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> c, <span class="at">y =</span> l)) <span class="sc">+</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> s, <span class="at">color =</span> <span class="fu">factor</span>(item)), <span class="at">data =</span> simDF, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> col), <span class="at">width =</span> <span class="fl">2.5</span>, <span class="at">height =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_identity</span>(<span class="at">aesthetics =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> item_cols, <span class="at">aesthetics =</span> <span class="st">"color"</span>, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>)) <span class="sc">+</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chroma (saturation)"</span>, <span class="at">y =</span> <span class="st">"Luminance (brightness)"</span>, <span class="at">subtitle =</span> <span class="st">"Contours of equal similarity"</span>, <span class="at">caption =</span> <span class="fu">bquote</span>(<span class="fu">list</span>(<span class="fu">plain</span>(hue) <span class="sc">==</span> .(<span class="fu">round</span>(hue)), c <span class="sc">==</span> .(<span class="fu">signif</span>(sens, <span class="dv">3</span>)), m[<span class="dv">1</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(strength[<span class="dv">1</span>], <span class="dv">3</span>)), m[<span class="dv">2</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(strength[<span class="dv">2</span>], <span class="dv">3</span>)))))</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>sumSimPlot <span class="ot">&lt;-</span> simDF <span class="sc">%&gt;%</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(c, l) <span class="sc">%&gt;%</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">summed_sim =</span> <span class="fu">sum</span>(s), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> c, <span class="at">y =</span> l, <span class="at">fill =</span> summed_sim)) <span class="sc">+</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"magma"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>)) <span class="sc">+</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chroma (saturation)"</span>, <span class="at">y =</span> <span class="st">"Luminance (brightness)"</span>, <span class="at">subtitle =</span> <span class="st">"Summed similarity"</span>, <span class="at">caption =</span> <span class="fu">bquote</span>(<span class="fu">list</span>(<span class="fu">plain</span>(hue) <span class="sc">==</span> .(<span class="fu">round</span>(hue)), c <span class="sc">==</span> .(<span class="fu">signif</span>(sens, <span class="dv">3</span>)), m[<span class="dv">1</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(strength[<span class="dv">1</span>], <span class="dv">3</span>)), m[<span class="dv">2</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(strength[<span class="dv">2</span>], <span class="dv">3</span>)))))</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>conPlot <span class="sc">+</span> sumSimPlot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ebrw_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="trace-specificity" class="level4" data-number="9.1.2.2">
<h4 data-number="9.1.2.2" class="anchored" data-anchor-id="trace-specificity"><span class="header-section-number">9.1.2.2</span> Trace specificity</h4>
<p>The specificity parameter <span class="math inline">\(c\)</span> represents the fact that items are assumed to be encoded with some degree of error/uncertainty. Just as items may be encoded with more or less strength, it is reasonable to assume that items can be encoded in memory with more or less specificity. Thus, we add a subscript to the <span class="math inline">\(c\)</span> parameter corresponding to each study item: <span class="math display">\[
s_{qj} = m_j \exp \left( -c_j d_{qj} \right)
\]</span></p>
<p>If an item is encoded with high specificity, then it will only be perceived as similar to the probe if the probe is very close in psychological space. This is illustrated in the pair of graphs below, where item 2 is not only stronger (<span class="math inline">\(m_2 = 2\)</span> vs.&nbsp;<span class="math inline">\(m_1 = 1\)</span>) but also more precise (<span class="math inline">\(c_2 = 0.1\)</span> vs.&nbsp;<span class="math inline">\(c_1 = 0.05\)</span>).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">60</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>      <span class="dv">60</span>, <span class="dv">50</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>specificity <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>strength <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>colDF <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">h =</span> hue, <span class="at">c =</span> X[,<span class="dv">1</span>], <span class="at">l =</span> X[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">hcl</span>(h, c, l)) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>item_cols <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(colDF<span class="sc">$</span>col)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(item_cols) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(item_cols))</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>simDF <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">c =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">70</span>, <span class="at">length.out=</span><span class="dv">101</span>), <span class="at">l =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">70</span>, <span class="at">length.out=</span><span class="dv">101</span>), <span class="at">item =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">sqrt</span>((c <span class="sc">-</span> X[item, <span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (l <span class="sc">-</span> X[item, <span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">s =</span> <span class="fu">exp</span>(<span class="sc">-</span>specificity[item] <span class="sc">*</span> d) <span class="sc">*</span> strength[item])</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>conPlot <span class="ot">&lt;-</span> colDF <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> c, <span class="at">y =</span> l)) <span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> s, <span class="at">color =</span> <span class="fu">factor</span>(item)), <span class="at">data =</span> simDF, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> col), <span class="at">width =</span> <span class="fl">2.5</span>, <span class="at">height =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_identity</span>(<span class="at">aesthetics =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> item_cols, <span class="at">aesthetics =</span> <span class="st">"color"</span>, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>)) <span class="sc">+</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chroma (saturation)"</span>, <span class="at">y =</span> <span class="st">"Luminance (brightness)"</span>, <span class="at">subtitle =</span> <span class="st">"Contours of equal similarity"</span>, <span class="at">caption =</span> <span class="fu">bquote</span>(<span class="fu">list</span>(<span class="fu">plain</span>(hue) <span class="sc">==</span> .(<span class="fu">round</span>(hue)), m[<span class="dv">1</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(strength[<span class="dv">1</span>], <span class="dv">3</span>)), m[<span class="dv">2</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(strength[<span class="dv">2</span>], <span class="dv">3</span>)), c[<span class="dv">1</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(specificity[<span class="dv">1</span>], <span class="dv">3</span>)), c[<span class="dv">2</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(specificity[<span class="dv">2</span>], <span class="dv">3</span>)))))</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>sumSimPlot <span class="ot">&lt;-</span> simDF <span class="sc">%&gt;%</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(c, l) <span class="sc">%&gt;%</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">summed_sim =</span> <span class="fu">sum</span>(s), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> c, <span class="at">y =</span> l, <span class="at">fill =</span> summed_sim)) <span class="sc">+</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"magma"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>)) <span class="sc">+</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chroma (saturation)"</span>, <span class="at">y =</span> <span class="st">"Luminance (brightness)"</span>, <span class="at">subtitle =</span> <span class="st">"Summed similarity"</span>, <span class="at">caption =</span> <span class="fu">bquote</span>(<span class="fu">list</span>(<span class="fu">plain</span>(hue) <span class="sc">==</span> .(<span class="fu">round</span>(hue)), m[<span class="dv">1</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(strength[<span class="dv">1</span>], <span class="dv">3</span>)), m[<span class="dv">2</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(strength[<span class="dv">2</span>], <span class="dv">3</span>)), c[<span class="dv">1</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(specificity[<span class="dv">1</span>], <span class="dv">3</span>)), c[<span class="dv">2</span>] <span class="sc">==</span> .(<span class="fu">signif</span>(specificity[<span class="dv">2</span>], <span class="dv">3</span>)))))</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>conPlot <span class="sc">+</span> sumSimPlot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ebrw_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="making-a-recognition-decision-from-random-walk-to-diffusion" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="making-a-recognition-decision-from-random-walk-to-diffusion"><span class="header-section-number">9.2</span> Making a recognition decision: From random walk to diffusion</h2>
<p>According to the EBRW, each trace <span class="math inline">\(j\)</span> in memory <em>races</em> to be retrieved at a rate proportional to its perceived similarity to the probe item, <span class="math inline">\(s_{qj}\)</span>. Traces race not just against one another, but against a <strong>criterion</strong>. If a memory trace wins the race, this is taken as evidence that the probe item matches something in memory, thus favoring a “yes” recognition response. If the criterion wins the race instead, this is taken as evidence that the probe item does <em>not</em> match anything in memory, thus favoring a “no” recognition response.</p>
<p>The idea is that, if the probe item matches something in memory, then the corresponding memory trace (or one sufficiently similar to probably match) should be able to win against the criterion. If nothing wins against the criterion, then this suggests there are no traces in memory that are a good match to the probe.</p>
<section id="accumulating-memory-evidence" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="accumulating-memory-evidence"><span class="header-section-number">9.2.1</span> Accumulating memory evidence</h3>
<p>The outcome of each race is added to a running tally which starts at zero. The value of the tally at any given time <span class="math inline">\(t\)</span>, which we can denote <span class="math inline">\(x(t)\)</span>, constitutes the current state of evidence from memory for making a recognition decision. Assume that each race takes <span class="math inline">\(\Delta t\)</span> seconds to complete. Each time a memory trace wins the race, the tally gets incremented by one; each time the criterion wins the race, the tally gets decremented by one. Put formally, we can write this process as <span class="math display">\[
x\left( t + \Delta t \right) =
\begin{cases}
x\left( t \right) + 1 &amp; \text{if trace wins} \\
x\left( t \right) - 1 &amp; \text{if criterion wins}
\end{cases}
\]</span> where <span class="math inline">\(x(0) = 0\)</span>.</p>
</section>
<section id="step-probabilities" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="step-probabilities"><span class="header-section-number">9.2.2</span> Step probabilities</h3>
<p>Although we have specified that whether memory evidence goes up or down depends on whether a trace or the criterion wins the race, we have not yet specified how the outcome of that race is determined. The winner of each race is random but depends on the similarity <span class="math inline">\(s_{qj}\)</span> between each trace <span class="math inline">\(j\)</span> and the probe <span class="math inline">\(q\)</span>. Specifically, trace <span class="math inline">\(j\)</span> wins the race with probability: <span class="math display">\[
\frac{s_{qj}}{\sum_{k = 1}^N s_{qk} + \kappa}
\]</span> where <span class="math inline">\(\kappa\)</span> is a nonnegative number that represents how stringent the criterion is. In other words, the equation above says that the probability that trace <span class="math inline">\(j\)</span> wins the race is the similarity between trace <span class="math inline">\(j\)</span> and the probe <span class="math inline">\(q\)</span> divided by the summed similarity across all traces <em>plus</em> the criterion <span class="math inline">\(\kappa\)</span>. In a sense, we can think of the criterion is like a “virtual memory trace” that races alongside the <span class="math inline">\(N\)</span> actual memory traces.</p>
<p>Remember that we increment memory strength whenever <em>any</em> trace wins the race, regardless of which one it is. Because only one trace can win each race, the probability that <em>any</em> trace wins is just the sum of the probabilities of winning across all <span class="math inline">\(N\)</span> traces, i.e.: <span class="math display">\[
p = \sum_{j = 1}^N \frac{s_{qj}}{\sum_{k = 1}^N s_{qk} + \kappa} = \frac{1}{\sum_{k = 1}^N s_{qk} + \kappa} \left( \sum_{j = 1}^Ns_{qj} \right) = \frac{S}{S + \kappa}
\]</span> where <span class="math inline">\(S = \sum_{j = 1}^N s_{qj}\)</span> is the summed similarity across all <span class="math inline">\(N\)</span> traces. The quantity <span class="math inline">\(p\)</span> is the probability that the random walk takes a step up.</p>
<p>The EBRW models the speed of decision making in terms of how many races must be run until the accumulated win advantage in favor of either a “yes” or “no” response reaches a decision boundary. To convert this to “real time”, we must say how long each race takes and allow for a <strong>residual time</strong>. Above, we used <span class="math inline">\(\Delta t\)</span> to stand for the amount of time (in seconds) each race takes to run. It will be convenient later to think instead of <span class="math inline">\(\nu = \frac{1}{\Delta t}\)</span>, where <span class="math inline">\(\nu\)</span> is the number of races per second.</p>
<p>The figure below shows an example of how memory evidence evolves during a single trial in which <span class="math inline">\(p = 0.55\)</span>, <span class="math inline">\(\nu = 40\)</span>, <span class="math inline">\(B_{Upper} = 7\)</span>, <span class="math inline">\(B_{Lower} = -8\)</span>, and <span class="math inline">\(t_0 = 0.2\)</span>. In addition, the graphs above and below the evidence trajectory illustrate the relative frequency with which, across many identical trials, each type of response would be made at each unit of time. Note that these distributions are discrete because the random walk operates in discrete time intervals, each of duration <span class="math inline">\(\Delta t\)</span> (which in this example is <span class="math inline">\(\Delta t = \frac{1}{\nu} = 0.025\)</span> seconds).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.55</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">7</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>resid <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">### RT distributions</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>Y_rw <span class="ot">&lt;-</span> <span class="fu">seq</span>(B[<span class="dv">1</span>], B[<span class="dv">2</span>])</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>P_rw <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(Y_rw), <span class="at">ncol =</span> <span class="fu">length</span>(Y_rw))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>P_rw[<span class="fu">cbind</span>(<span class="dv">2</span><span class="sc">:</span>(<span class="fu">nrow</span>(P_rw) <span class="sc">-</span> <span class="dv">1</span>), <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(P_rw) <span class="sc">-</span> <span class="dv">2</span>))] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>P_rw[<span class="fu">cbind</span>(<span class="dv">2</span><span class="sc">:</span>(<span class="fu">nrow</span>(P_rw) <span class="sc">-</span> <span class="dv">1</span>), <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(P_rw))] <span class="ot">&lt;-</span> p</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>P_rw[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> P_rw[<span class="fu">nrow</span>(P_rw), <span class="fu">ncol</span>(P_rw)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="do">### Simulation</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    winner <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    x_rw <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        s <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">&lt;</span> p) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        x_rw <span class="ot">&lt;-</span> <span class="fu">c</span>(x_rw, x_rw[<span class="fu">length</span>(x_rw)] <span class="sc">+</span> s)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (x_rw[<span class="fu">length</span>(x_rw)] <span class="sc">&lt;=</span> B[<span class="dv">1</span>]) {</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>            winner <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (x_rw[<span class="fu">length</span>(x_rw)] <span class="sc">&gt;=</span> B[<span class="dv">2</span>]) {</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>            winner <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (winner <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> (<span class="fu">length</span>(x_rw) <span class="sc">/</span> nu) <span class="sc">&gt;</span> <span class="fl">1.5</span>) {</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>RT_rw <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x_rw))</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>Z_rw <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> <span class="fu">c</span>(Y_rw <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x_rw)) {</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    Z_rw <span class="ot">&lt;-</span> Z_rw <span class="sc">%*%</span> P_rw</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    RT_rw[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> Z_rw[<span class="dv">1</span>]</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    RT_rw[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> Z_rw[<span class="fu">length</span>(Z_rw)]</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>dRT_rw <span class="ot">&lt;-</span> <span class="fu">apply</span>(RT_rw, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> diff) <span class="sc">*</span> nu <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>rtPlot1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">t =</span> resid <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x_rw) <span class="sc">/</span> nu, <span class="at">p =</span> <span class="fu">c</span>(<span class="dv">0</span>, dRT_rw[,<span class="dv">2</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> p)) <span class="sc">+</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"#eeb211"</span>, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">width =</span> <span class="dv">1</span> <span class="sc">/</span> nu) <span class="sc">+</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">c</span>(dRT_rw)))) <span class="sc">+</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Pr(Respond at time t)"</span>) <span class="sc">+</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>rtPlot0 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">t =</span> resid <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x_rw) <span class="sc">/</span> nu, <span class="at">p =</span> <span class="fu">c</span>(<span class="dv">0</span>, dRT_rw[,<span class="dv">1</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> p)) <span class="sc">+</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"#46166b"</span>, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">width =</span> <span class="dv">1</span> <span class="sc">/</span> nu) <span class="sc">+</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Pr(Respond at time t)"</span>) <span class="sc">+</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">max</span>(<span class="fu">c</span>(dRT_rw)), <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>rwPlot <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">t =</span> resid <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x_rw) <span class="sc">/</span> nu, <span class="at">x =</span> x_rw) <span class="sc">%&gt;%</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> x)) <span class="sc">+</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_step</span>(<span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> B[<span class="dv">2</span>], <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"#eeb211"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> B[<span class="dv">1</span>], <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"#46166b"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> resid, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#666666"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> B[<span class="dv">2</span>], <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"B[Upper] == "</span>, B[<span class="dv">2</span>])), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label), <span class="at">color =</span> <span class="st">"#eeb211"</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> B[<span class="dv">1</span>], <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"B[Lower] == "</span>, B[<span class="dv">1</span>])), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label), <span class="at">color =</span> <span class="st">"#46166b"</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> resid, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"t[0] == "</span>, resid)), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label), <span class="at">color =</span> <span class="st">"#666666"</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Retrieval time (s)"</span>, <span class="at">y =</span> <span class="st">"Memory evidence"</span>, <span class="at">caption =</span> <span class="fu">bquote</span>(<span class="fu">list</span>(p <span class="sc">==</span> .(p), nu <span class="sc">==</span> .(nu))))</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>rtPlot1 <span class="sc">+</span> rwPlot <span class="sc">+</span> rtPlot0 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.75</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ebrw_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="from-discrete-random-walk-to-continuous-diffusion" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="from-discrete-random-walk-to-continuous-diffusion"><span class="header-section-number">9.2.3</span> From discrete random walk to continuous diffusion</h3>
<p>A random walk takes discrete-valued steps either up or down in discrete units of time. A Wiener diffusion process takes continuous-valued steps sampled from a normal distribution in infinitely small units of time, thus effectively operating in continuous time. We are going to approximate the discrete EBRW with a continuous diffusion process (so technically we should call this model the EBD for Exemplar-Based Diffusion, but we will keep calling it the EBRW for posterity).</p>
<p>In going from a random walk to a diffusion model, we are making an important psychological claim: We are saying that, instead of memory evidence arriving in discrete units at regular intervals, memory evidence is a continuous value that continually evolves as new information arrives. We can think of this as saying that, instead of only knowing the outcome of each race, you can see who is ahead and who is behind at any given time; this is the move from discrete time to continuous time. Moreover, instead of only scoring each race as a win or loss for the memory traces, the races are assigned a continuous value depending on how clear the winner is; this is the move from discrete evidence to continuous evidence.</p>
<section id="mean-and-standard-deviation-of-diffusion" class="level4" data-number="9.2.3.1">
<h4 data-number="9.2.3.1" class="anchored" data-anchor-id="mean-and-standard-deviation-of-diffusion"><span class="header-section-number">9.2.3.1</span> Mean and standard deviation of diffusion</h4>
<p>We can write the update equation for the random walk like we did above: <span class="math display">\[
\begin{align}
x \left( t + \Delta t \right) &amp; = \begin{cases} x(t) + 1 &amp; \text{with probability } p \\ x(t) - 1 &amp; \text{with probability } 1 - p \end{cases} \\
x \left( t + \Delta t \right) - x(t) &amp; = \begin{cases} 1 &amp; \text{with probability } p \\ -1 &amp; \text{with probability } 1 - p \end{cases} \\
x \left( t + \Delta t \right) - x(t) &amp; \sim 2 \times \text{Bernoulli} \left( p \right) - 1
\end{align}
\]</span> where we have rearranged terms and used the shorthand in the final line to emphasize the idea that each step of the random walk can be thought of as a sample from a Bernoulli distribution with parameter <span class="math inline">\(p\)</span> that is then transformed from <span class="math inline">\(\lbrace 0, 1 \rbrace\)</span> to <span class="math inline">\(\lbrace -1, 1 \rbrace\)</span>.</p>
<p>To turn this into a continuous diffusion process, we need to swap out the transformed Bernoulli distribution with a normal distribution that has the same mean and variance. The mean is <span class="math inline">\(2 p - 1\)</span> and the variance is <span class="math inline">\(4 p \left(1 - p \right)\)</span>. One more thing: remember that we run <span class="math inline">\(\nu\)</span> races per second, so we need to multiply the mean and variance by <span class="math inline">\(\nu\)</span>. Therefore, the mean drift rate is <span class="math inline">\(v = \nu \left(2 p - 1 \right)\)</span> and the variance is <span class="math inline">\(\sigma^2 = 4 \nu p (1 - p)\)</span>.</p>
<p>Note that this is different from the typical diffusion model where the variance of the evidence samples is arbitrarily fixed to 1. Notice an important property of this variance: It is largest when <span class="math inline">\(p = 0.5\)</span> and approaches zero as <span class="math inline">\(p\)</span> approaches either 0 or 1. In other words, the more uncertain the outcome of each race, the more noise there is in the diffusion. This is illustrated below:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expand_grid</span>(<span class="at">p =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">101</span>), <span class="at">nu =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sigma2 =</span> <span class="dv">4</span> <span class="sc">*</span> nu <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p)) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> sigma2, <span class="at">color =</span> nu, <span class="at">group =</span> nu)) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> p, <span class="at">y =</span> <span class="fu">expression</span>(sigma<span class="sc">^</span><span class="dv">2</span>), <span class="at">color =</span> <span class="fu">expression</span>(nu)) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
3.5.0.
ℹ Please use the `legend.position.inside` argument of `theme()` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ebrw_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To summarize, the difference between the random walk and the diffusion is that we have swapped out a discrete binomial distribution of evidence increments per unit time with a continuous normal distribution of evidence increments per unit time. Everything else is the same: You still respond “yes” if and when the accumulated evidence <span class="math inline">\(x(t)\)</span> reaches either the upper boundary or the lower boundary.</p>
</section>
<section id="closeness-of-predictions" class="level4" data-number="9.2.3.2">
<h4 data-number="9.2.3.2" class="anchored" data-anchor-id="closeness-of-predictions"><span class="header-section-number">9.2.3.2</span> Closeness of predictions</h4>
<p>To illustrate how well the diffusion process approximates the random walk, the graphs below show the diffusion approximation to the same random walk example used above. The smooth lines in the upper and lower graphs are the probability of responding per unit time (i.e., the probability density function) according to the Wiener diffusion model. The open bars are the same probabilities from the random walk. The diffusion model’s predictions hew very closely to those of the random walk!</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> nu <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> p <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">*</span> nu <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>boundsep <span class="ot">&lt;-</span> B[<span class="dv">2</span>] <span class="sc">-</span> B[<span class="dv">1</span>]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (<span class="dv">0</span> <span class="sc">-</span> B[<span class="dv">1</span>]) <span class="sc">/</span> (B[<span class="dv">2</span>] <span class="sc">-</span> B[<span class="dv">1</span>])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>delta_t <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    winner_diff <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    x_diff <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        x_diff <span class="ot">&lt;-</span> <span class="fu">c</span>(x_diff, x_diff[<span class="fu">length</span>(x_diff)] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mean =</span> mu <span class="sc">*</span> delta_t, <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma2 <span class="sc">*</span> delta_t)))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (x_diff[<span class="fu">length</span>(x_diff)] <span class="sc">&lt;=</span> B[<span class="dv">1</span>]) {</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>            winner_diff <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (x_diff[<span class="fu">length</span>(x_diff)] <span class="sc">&gt;=</span> B[<span class="dv">2</span>]) {</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>            winner_diff <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (winner <span class="sc">==</span> winner_diff <span class="sc">&amp;</span> <span class="fu">abs</span>((<span class="fu">length</span>(x_diff) <span class="sc">*</span> delta_t) <span class="sc">-</span> (<span class="fu">length</span>(x_rw) <span class="sc">/</span> nu)) <span class="sc">&lt;</span> (<span class="dv">1</span> <span class="sc">/</span> nu)) {</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>x_diff <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="fu">pmin</span>(x_diff, B[<span class="dv">2</span>]), B[<span class="dv">1</span>])</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(x_diff)) <span class="sc">*</span> delta_t</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>dRT_diff <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">WienerPDF</span>(<span class="at">t =</span> t, <span class="at">response =</span> <span class="st">"lower"</span>, <span class="at">a =</span> boundsep <span class="sc">/</span> <span class="fu">sqrt</span>(sigma2), <span class="at">v =</span> mu <span class="sc">/</span> <span class="fu">sqrt</span>(sigma2), <span class="at">w =</span> bias)<span class="sc">$</span>value,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">WienerPDF</span>(<span class="at">t =</span> t, <span class="at">response =</span> <span class="st">"upper"</span>, <span class="at">a =</span> boundsep <span class="sc">/</span> <span class="fu">sqrt</span>(sigma2), <span class="at">v =</span> mu <span class="sc">/</span> <span class="fu">sqrt</span>(sigma2), <span class="at">w =</span> bias)<span class="sc">$</span>value</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>rtPlot1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">t =</span> resid <span class="sc">+</span> t, <span class="at">p =</span> dRT_diff[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> p)) <span class="sc">+</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">t =</span> resid <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x_rw) <span class="sc">/</span> nu, <span class="at">p =</span> <span class="fu">c</span>(<span class="dv">0</span>, dRT_rw[,<span class="dv">2</span>])), <span class="at">color =</span> <span class="st">"#eeb211aa"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">width =</span> <span class="dv">1</span> <span class="sc">/</span> nu) <span class="sc">+</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">"#eeb21177"</span>, <span class="at">color =</span> <span class="st">"#eeb211"</span>) <span class="sc">+</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">c</span>(dRT_diff)))) <span class="sc">+</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Pr(Respond at time t)"</span>) <span class="sc">+</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>rtPlot0 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">t =</span> resid <span class="sc">+</span> t, <span class="at">p =</span> dRT_diff[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> p)) <span class="sc">+</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">t =</span> resid <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x_rw) <span class="sc">/</span> nu, <span class="at">p =</span> <span class="fu">c</span>(<span class="dv">0</span>, dRT_rw[,<span class="dv">1</span>])), <span class="at">color =</span> <span class="st">"#46166baa"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">width =</span> <span class="dv">1</span> <span class="sc">/</span> nu) <span class="sc">+</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">"#46166b77"</span>, <span class="at">color =</span> <span class="st">"#46166b"</span>) <span class="sc">+</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Pr(Respond at time t)"</span>) <span class="sc">+</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">max</span>(<span class="fu">c</span>(dRT_diff)), <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>rwPlot <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">t =</span> resid <span class="sc">+</span> t, <span class="at">x =</span> x_diff) <span class="sc">%&gt;%</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> x)) <span class="sc">+</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> B[<span class="dv">2</span>], <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"#eeb211"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> B[<span class="dv">1</span>], <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"#46166b"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> resid, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#666666"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> B[<span class="dv">2</span>], <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"B[Upper] == "</span>, B[<span class="dv">2</span>])), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label), <span class="at">color =</span> <span class="st">"#eeb211"</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> B[<span class="dv">1</span>], <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"B[Lower] == "</span>, B[<span class="dv">1</span>])), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label), <span class="at">color =</span> <span class="st">"#46166b"</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> resid, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"t[0] == "</span>, resid)), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label), <span class="at">color =</span> <span class="st">"#666666"</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Retrieval time (s)"</span>, <span class="at">y =</span> <span class="st">"Memory evidence"</span>, <span class="at">caption =</span> <span class="fu">bquote</span>(<span class="fu">list</span>(p <span class="sc">==</span> .(p), nu <span class="sc">==</span> .(nu), v <span class="sc">==</span> .(<span class="fu">signif</span>(mu, <span class="dv">3</span>)), sigma <span class="sc">==</span> .(<span class="fu">signif</span>(<span class="fu">sqrt</span>(sigma2), <span class="dv">3</span>)))))</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>rtPlot1 <span class="sc">+</span> rwPlot <span class="sc">+</span> rtPlot0 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.75</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ebrw_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="implementation-in-r" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="implementation-in-r"><span class="header-section-number">9.3</span> Implementation in R</h2>
<p>To find the EBRW parameters that best fit the recognition data from a participant, let’s implement the diffusion version of the EBRW in R using the <code>WienR</code> package. We must define a function to compute the negative log-likelihood (NLL) for a set of observed responses/RT’s, given a set of parameters. The function itself, in outline form, looks like the one below. I have written comments for the things that the function needs to accomplish to get from what is given to the function (in the parentheses following <code>function</code>) to what the function needs to <code>return</code> at the end.</p>
<p>For example purposes, this implementation doesn’t include all of the bells and whistles that the full model includes. It will not allow for varying trace strength nor will it include attention weights on each dimension. This is meant to illustrate the basic idea that we can define a diffusion model in which the drift rates are derived from a theory, rather than just estimated.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function arguments:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par: this is a named vector of parameter values</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stim_coords: this is a matrix of the coordinates of the stimuli, where each row is a stimulus and each column is a dimension</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># study_items: this is a matrix where each row is a trial and each column indicates the items that were studied on that trial</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># probe_item: this is a vector giving the index of the probe item on each trial</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># response: this is a vector where each value is 2 or 1, depending on whether the participant responded "yes" (2) or "no" (1) on that trial</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rt: this is a vector of the response times from each trial</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>ebrw_nll <span class="ot">&lt;-</span> <span class="cf">function</span>(par, stim_coords, study_items, probe_item, response, rt) {</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Compute the mean and SD of the drift for each trial</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Calculate the log-likelihood of each observed response/RT on each trial</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. Return final result</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(nll)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s now fill in each of those sections in turn.</p>
<section id="parameters" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="parameters"><span class="header-section-number">9.3.1</span> Parameters</h3>
<p>The vector <code>par</code> that is the first argument to the <code>ebrw_nll</code> function should be a <em>named</em> vector that has the following entries:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>par <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"retrieval_rate"</span> <span class="ot">=</span> <span class="dv">3</span>,     <span class="co"># This is the "nu" parameter</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"a"</span> <span class="ot">=</span> <span class="dv">2</span>,                  <span class="co"># Response caution</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"w"</span> <span class="ot">=</span> <span class="fl">0.5</span>,                <span class="co"># Response bias</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t0"</span> <span class="ot">=</span> <span class="dv">0</span>,                 <span class="co"># Residual time</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"specificity"</span> <span class="ot">=</span> <span class="dv">1</span>,        <span class="co"># Specificity of memory representations (the "c" parameter)</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"criterion"</span> <span class="ot">=</span> <span class="dv">1</span>           <span class="co"># Criterion (the "kappa" parameter)</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="computing-the-mean-and-sd-of-the-drift-for-each-trial" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2" class="anchored" data-anchor-id="computing-the-mean-and-sd-of-the-drift-for-each-trial"><span class="header-section-number">9.3.2</span> Computing the mean and SD of the drift for each trial</h3>
<p>Recall that the drift rates depend on the distances between each of the stimulus items. Since the function is provided with <code>stim_coords</code>, we can make our job a little easier by using the <code>dist</code> function to compute the matrix of distances between all pairs of items. This saves us from “recomputing” the distances between pairs of items that occur on multiple trials:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>stim_dists <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(stim_coords))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then, to compute the summed similarity for each trial <code>i</code>, we can use a <code>for</code> loop:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>evidence_mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>evidence_sd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    summed_sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span>par[<span class="st">"specificity"</span>] <span class="sc">*</span> stim_dists[probe_item[i], study_items[i,]]))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> summed_sim <span class="sc">/</span> (summed_sim <span class="sc">+</span> par[<span class="st">"criterion"</span>])</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    evidence_mean[i] <span class="ot">&lt;-</span> par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> p <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    evidence_sd[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We have now completed the second step of writing the <code>ebrw_nll</code> function, as summarized below.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function arguments:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par: this is a named vector of parameter values</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stim_coords: this is a matrix of the coordinates of the stimuli, where each row is a stimulus and each column is a dimension</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># study_items: this is a matrix where each row is a trial and each column indicates the items that were studied on that trial</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># probe_item: this is a vector giving the index of the probe item on each trial</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># response: this is a vector where each value is 2 or 1, depending on whether the participant responsed "yes" (2) or "no" (1) on that trial</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rt: this is a vector of the response times from each trial</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>ebrw_nll <span class="ot">&lt;-</span> <span class="cf">function</span>(par, stim_coords, study_items, probe_item, response, rt) {</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Compute the mean and SD of the drift for each trial</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    stim_dists <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(stim_coords))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    evidence_mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    evidence_sd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        summed_sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span>par[<span class="st">"specificity"</span>] <span class="sc">*</span> stim_dists[probe_item[i], study_items[i,]]))</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> summed_sim <span class="sc">/</span> (summed_sim <span class="sc">+</span> par[<span class="st">"criterion"</span>])</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        evidence_mean[i] <span class="ot">&lt;-</span> par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> p <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        evidence_sd[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Calculate the log-likelihood of each observed response/RT on each trial</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. Return final result</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(nll)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="calculating-the-log-likelihood" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3" class="anchored" data-anchor-id="calculating-the-log-likelihood"><span class="header-section-number">9.3.3</span> Calculating the log-likelihood</h3>
<p>This step is almost too easy. We are using the <code>WienR</code> package, which means we can use the <code>WienerPDF</code> function like we’ve seen already. There is only one thing we need to do: The <code>WienerPDF</code> function assumes that the standard deviation of the diffusion is always equal to one. As such, we need to <em>standardize</em> the drift rate and boundary separation before we send them to the <code>WienerPDF</code> function by dividing each by <code>evidence_sd</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function arguments:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par: this is a named vector of parameter values</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stim_coords: this is a matrix of the coordinates of the stimuli, where each row is a stimulus and each column is a dimension</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># study_items: this is a matrix where each row is a trial and each column indicates the items that were studied on that trial</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># probe_item: this is a vector giving the index of the probe item on each trial</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># response: this is a vector where each value is 2 or 1, depending on whether the participant responsed "yes" (2) or "no" (1) on that trial</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rt: this is a vector of the response times from each trial</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>ebrw_nll <span class="ot">&lt;-</span> <span class="cf">function</span>(par, stim_coords, study_items, probe_item, response, rt) {</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Compute the mean and SD of the drift for each trial</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    stim_dists <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(stim_coords))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    evidence_mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    evidence_sd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        summed_sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span>par[<span class="st">"specificity"</span>] <span class="sc">*</span> stim_dists[probe_item[i], study_items[i,]]))</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> summed_sim <span class="sc">/</span> (summed_sim <span class="sc">+</span> par[<span class="st">"criterion"</span>])</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        evidence_mean[i] <span class="ot">&lt;-</span> par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> p <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>        evidence_sd[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Calculate the log-likelihood of each observed response/RT on each trial</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">WienerPDF</span>(</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">t =</span> rt,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">response =</span> response,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">a =</span> par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_sd,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">w =</span> par[<span class="st">"w"</span>],</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">v =</span> evidence_mean <span class="sc">/</span> evidence_sd,</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">t0 =</span> par[<span class="st">"t0"</span>]</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. Return final result</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(result<span class="sc">$</span>logvalue))</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="error-checking" class="level3" data-number="9.3.4">
<h3 data-number="9.3.4" class="anchored" data-anchor-id="error-checking"><span class="header-section-number">9.3.4</span> Error-checking</h3>
<p>It is important for us to do some error checking. Sometimes, a particular combination of parameters will make it impossible for the <code>WienerPDF</code> function to calculate the log-likelihood. When that happens, it gives an error. In essence, such a result tells us that the model cannot work with that combination of parameters. Thus, rather than an “error”, that is really telling us that we should assign zero likelihood to that set of parameters, which is equivalent to a log-likelihood of <span class="math inline">\(-\infty\)</span>.</p>
<p>We can do that kind of check in R by putting the <code>WienerPDF</code> function call within <code>try()</code>. If the <code>WienerPDF</code> function gives an error, then the result that gets stored in <code>trial_wiener</code> is also an error. Otherwise, it just gives us the log-likelihoods that we want.</p>
<p>Let’s set up an “if…else” structure to do this check:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function arguments:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par: this is a named vector of parameter values</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stim_coords: this is a matrix of the coordinates of the stimuli, where each row is a stimulus and each column is a dimension</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># study_items: this is a matrix where each row is a trial and each column indicates the items that were studied on that trial</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># probe_item: this is a vector giving the index of the probe item on each trial</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># response: this is a vector where each value is 2 or 1, depending on whether the participant responsed "yes" (2) or "no" (1) on that trial</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rt: this is a vector of the response times from each trial</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>ebrw_nll <span class="ot">&lt;-</span> <span class="cf">function</span>(par, stim_coords, study_items, probe_item, response, rt) {</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Compute the mean and SD of the drift for each trial</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    stim_dists <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(stim_coords))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    evidence_mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    evidence_sd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>        summed_sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span>par[<span class="st">"specificity"</span>] <span class="sc">*</span> stim_dists[probe_item[i], study_items[i,]]))</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> summed_sim <span class="sc">/</span> (summed_sim <span class="sc">+</span> par[<span class="st">"criterion"</span>])</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        evidence_mean[i] <span class="ot">&lt;-</span> par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> p <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        evidence_sd[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Calculate the log-likelihood of each observed response/RT on each trial</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">WienerPDF</span>(</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">t =</span> rt,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">response =</span> response,</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">a =</span> par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_sd,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">w =</span> par[<span class="st">"w"</span>],</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">v =</span> evidence_mean <span class="sc">/</span> evidence_sd,</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">t0 =</span> par[<span class="st">"t0"</span>]</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. Return final result</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">class</span>(result) <span class="sc">==</span> <span class="st">"try-error"</span>) {</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="cn">Inf</span>)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(result<span class="sc">$</span>logvalue))</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="a-worked-example" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="a-worked-example"><span class="header-section-number">9.4</span> A worked example</h2>
<p>This example uses a single participant’s data from Experiment 2 of <span class="citation" data-cites="GillespieCox2024">Gillespie &amp; Cox (<a href="references.html#ref-GillespieCox2024" role="doc-biblioref">2024</a>)</span>. In this experiment, each participant made similarity ratings between all pairs of eight items. Each item was an “auditory texture” constructed via Fourier synthesis. We applied Multidimensional Scaling to the similarity ratings from each participant to assign, for each participant, a set of coordinates to each item. The coordinates are such that items that are farther from one another were associated with lower similarity ratings and those that were closer to one another were assigned higher similarity ratings. Be sure to check out the paper itself for additional detail on how this was done, and how we decided that the multidimensional space in which the stimuli are represented had 3 dimensions. These coordinates will be used for the <code>stim_coords</code> argument of the <code>ebrw_nll</code> function.</p>
<p>In addition to providing similarity ratings, each participant engaged in a recognition memory task. On each trial of this task, the participant heard two auditory textures, presented sequentially. They then heard a “probe” sound and had to decide whether or not it was one of the two sounds that had just been presented. It is these recognition data that we will model with the EBRW.</p>
<p>You can grab the data yourself by running the following chunk of code to download it and load it into your R workspace:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">"https://github.com/gregcox7/choice_rt_models/raw/refs/heads/main/data/ebrw_example_data.rdata"</span>, <span class="st">"blast_data.rdata"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"ebrw_example_data.rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="check-out-the-data" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="check-out-the-data"><span class="header-section-number">9.4.1</span> Check out the data</h3>
<p>The stimulus coordinates are saved in a matrix called <code>stim_coords</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stim_coords)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]         [,2]        [,3]
[1,] -0.4679162 -0.463219039 -0.08056499
[2,] -0.5549266  0.499390636  0.07099460
[3,] -0.4742833 -0.132020672  0.43312165
[4,] -0.5062581  0.005578674 -0.40175331
[5,]  0.5110397 -0.222844222 -0.30381582
[6,]  0.4578305  0.336495895 -0.27302187
[7,]  0.5669455 -0.288366241  0.24624698
[8,]  0.4675684  0.264984969  0.30879277</code></pre>
</div>
</div>
<p>We can visualize them using <code>plot_ly</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>to_plot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(stim_coords)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(to_plot) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Dimension"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(stim_coords))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(to_plot) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Item"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(stim_coords))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> to_plot,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Dimension 1</span><span class="st">`</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Dimension 2</span><span class="st">`</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Dimension 3</span><span class="st">`</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"scatter3d"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">rownames</span>(to_plot),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">"markers+text"</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-254ba0c536aba6f5d5c3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-254ba0c536aba6f5d5c3">{"x":{"visdat":{"40ef963bb56":["function () ","plotlyVisDat"]},"cur_data":"40ef963bb56","attrs":{"40ef963bb56":{"x":{},"y":{},"z":{},"text":["Item 1","Item 2","Item 3","Item 4","Item 5","Item 6","Item 7","Item 8"],"mode":"markers+text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"`Dimension 1`"},"yaxis":{"title":"`Dimension 2`"},"zaxis":{"title":"`Dimension 3`"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-0.4679161611520406,-0.55492658286274077,-0.47428333513396143,-0.50625809279990275,0.51103974867404744,0.45783054068415885,0.56694547092957315,0.46756841166086582],"y":[-0.46321903909441836,0.49939063638984044,-0.13202067242339119,0.0055786743535065283,-0.22284422229517822,0.33649589490445841,-0.28836624054434484,0.26498496870952648],"z":[-0.080564994532971015,0.070994597405408214,0.43312164966214295,-0.40175330903355666,-0.3038158169562874,-0.27302187298276354,0.24624697977727203,0.30879276666075506],"text":["Item 1","Item 2","Item 3","Item 4","Item 5","Item 6","Item 7","Item 8"],"mode":"markers+text","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>In addition for each trial of the recognition task, the <code>study_items</code> matrix tells us which of the two items had been presented as part of the set to be remembered and the <code>probe_item</code> vector tells us what the probe item was. These numbers refer to row in the <code>stim_coords</code> matrix.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(study_items)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2]
 [1,]    3    5
 [2,]    3    6
 [3,]    8    1
 [4,]    1    7
 [5,]    2    4
 [6,]    7    2
 [7,]    6    7
 [8,]    8    3
 [9,]    3    4
[10,]    5    6
[11,]    6    8
[12,]    1    4
[13,]    4    8
[14,]    7    4
[15,]    6    1
[16,]    1    3
[17,]    1    2
[18,]    3    2
[19,]    6    4
[20,]    8    2
[21,]    3    7
[22,]    4    5
[23,]    5    2
[24,]    1    5
[25,]    7    8
[26,]    2    6
[27,]    7    5
[28,]    5    8</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(probe_item)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 4 2 1 7 2 7 7 2 6 6 6 1 3 4 4 3 8 3 8 4 7 8 4 2 6 2 3 5</code></pre>
</div>
</div>
<p>Finally, the <code>rt</code> and <code>response</code> vectors record the response time (in seconds) and the response (where <code>2</code> is “yes” and <code>1</code> is “no”) produced by this participant on each trial.</p>
</section>
<section id="finding-optimal-parameters" class="level3" data-number="9.4.2">
<h3 data-number="9.4.2" class="anchored" data-anchor-id="finding-optimal-parameters"><span class="header-section-number">9.4.2</span> Finding optimal parameters</h3>
<p>The version of the EBRW that we applied in our paper is a bit more complex than the one we will use here, which only has six free parameters. We will use R’s built-in <code>nlminb</code> function to find the best-fitting values of these parameters. To do this, we need to specify initial values for each parameter in a named vector, as shown below. These initial values don’t necessarily need to be anything in particular as long as they don’t cause the <code>ebrw_nll</code> function to return an error or a value of <code>Inf</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>init_par <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"retrieval_rate"</span> <span class="ot">=</span> <span class="dv">3</span>,     <span class="co"># This is the "nu" parameter</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"a"</span> <span class="ot">=</span> <span class="dv">2</span>,                  <span class="co"># Response caution</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"w"</span> <span class="ot">=</span> <span class="fl">0.5</span>,                <span class="co"># Response bias</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t0"</span> <span class="ot">=</span> <span class="dv">0</span>,                 <span class="co"># Residual time</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"specificity"</span> <span class="ot">=</span> <span class="dv">1</span>,        <span class="co"># Specificity of memory representations (the "c" parameter)</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"criterion"</span> <span class="ot">=</span> <span class="dv">1</span>           <span class="co"># Criterion (the "kappa" parameter)</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We also need to specify the upper and lower values that each of these parameters could possibly take, as shown below:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"retrieval_rate"</span> <span class="ot">=</span> <span class="dv">0</span>,     <span class="co"># This is the "nu" parameter</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"a"</span> <span class="ot">=</span> <span class="dv">0</span>,                  <span class="co"># Response caution</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"w"</span> <span class="ot">=</span> <span class="dv">0</span>,                  <span class="co"># Response bias</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t0"</span> <span class="ot">=</span> <span class="dv">0</span>,                 <span class="co"># Residual time</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"specificity"</span> <span class="ot">=</span> <span class="dv">0</span>,        <span class="co"># Specificity of memory representations (the "c" parameter)</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"criterion"</span> <span class="ot">=</span> <span class="dv">0</span>           <span class="co"># Criterion (the "kappa" parameter)</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"retrieval_rate"</span> <span class="ot">=</span> <span class="cn">Inf</span>,     <span class="co"># This is the "nu" parameter</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"a"</span> <span class="ot">=</span> <span class="cn">Inf</span>,                  <span class="co"># Response caution</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"w"</span> <span class="ot">=</span> <span class="dv">1</span>,                    <span class="co"># Response bias</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"t0"</span> <span class="ot">=</span> <span class="fu">min</span>(rt),             <span class="co"># Residual time</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"specificity"</span> <span class="ot">=</span> <span class="cn">Inf</span>,        <span class="co"># Specificity of memory representations (the "c" parameter)</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"criterion"</span> <span class="ot">=</span> <span class="cn">Inf</span>           <span class="co"># Criterion (the "kappa" parameter)</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Note that these upper and lower values can be <code>Inf</code>inite if necessary!</p>
<p>Finally, let’s use the <code>nlminb</code> function, which we need to provide with each of the ingredients we prepared above. We will save the result as <code>fit</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">nlminb</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">start =</span> init_par,          <span class="co"># Need to provide initial guess of parameter values</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">objective =</span> ebrw_nll,      <span class="co"># Tell R the name of the function to optimize</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> lower,             <span class="co"># The lower bounds on each parameter</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> upper,             <span class="co"># The upper bounds on each parameter</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">stim_coords =</span> stim_coords, <span class="co"># The coordinates of each stimulus</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rt =</span> rt,                   <span class="co"># The vector of RT's on each trial</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">response =</span> response,       <span class="co"># The vector of responses on each trial</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">study_items =</span> study_items, <span class="co"># The study items on each trial</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">probe_item =</span> probe_item    <span class="co"># The probe item on each trial</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlminb(start = init_par, objective = ebrw_nll, lower = lower, :
NA/NaN function evaluation</code></pre>
</div>
</div>
<p>And the final result!</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$par
retrieval_rate              a              w             t0    specificity 
     1.2474191      2.1459586      0.4488126      0.6884095      5.6470633 
     criterion 
     0.1035233 

$objective
[1] 21.59716

$convergence
[1] 0

$iterations
[1] 35

$evaluations
function gradient 
      56      243 

$message
[1] "relative convergence (4)"</code></pre>
</div>
</div>
<p>It may seem like a lot of work for such a simple result—six numbers! But it helps to take a step back and realize what we have just done. We had a participant provide similarity ratings for pairs of unusual auditory stimuli that they had never heard before. We found a way to <em>represent</em> how that participant perceives those stimuli in terms of coordinates in a multidimensional space. We could then infer, from their choices and response times in a recognition task, how well this participant could remember these stimuli and how they used perceived similarity to make their choices. We have explained why this participant did what they did not just in terms of accumulating evidence for a decision, but in terms of how they got that evidence from their memory for novel auditory stimuli.</p>
</section>
</section>
<section id="predictions-by-simulation-and-math" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="predictions-by-simulation-and-math"><span class="header-section-number">9.5</span> Predictions by simulation and math</h2>
<p>As impressive as it is to have “reverse-engineered” the contents of a participant’s memory from their behavior, there are still some pieces we have left out of the puzzle. Specifically, although we developed a function to calculate the NLL for the purpose of estimating parameters, we haven’t yet built a function to <em>simulate</em> data using the EBRW. That is the purpose of this section. We will also see some explicit mathematical formulae for predicting <em>average</em> performance without the need to run many simulations. In the end, this will enable us to (a) verify the quality of our model fit by comparing its predictions to observations; and (b) make predictions for novel experimental conditions that we may not have observed.</p>
<p>Finally, this section demonstrates a general technique that is often useful in programming a model: Having a single function that can return <em>either</em> the NLL <em>or</em> predictions. Since the model parameters have the same meaning regardless of whether we are calculating likelihoods or making predictions, we can just tell the function what we want it to do with those parameters. The value of this approach is that we won’t accidentally write simulation code that differs in some important way from our likelihood code. For example, if we change the parameters for our likelihood code, we want to make sure that our simulation code respects that change; the approach we take in this section forces us to do this and thereby keep our model consistent.</p>
<section id="simulating-individual-trials" class="level3" data-number="9.5.1">
<h3 data-number="9.5.1" class="anchored" data-anchor-id="simulating-individual-trials"><span class="header-section-number">9.5.1</span> Simulating individual trials</h3>
<p>First, we will see how we can modify our <code>ebrw_nll</code> function to return simulated behavior instead of just the negative log-likelihood of observed choices and RT’s. The chunk of code below gives an outline of our approach, which involves adding a new argument to the function called <code>n_sims</code>. By default, <code>n_sims = 0</code>, which indicates that the function should <em>not</em> do any simulation but should instead return the NLL, as it did above. As you might anticipate, we will need an <code>if...else</code> structure to check whether <code>n_sims &gt; 0</code> or not.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function arguments:</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par: this is a named vector of parameter values</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stim_coords: this is a matrix of the coordinates of the stimuli, where each row is a stimulus and each column is a dimension</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># study_items: this is a matrix where each row is a trial and each column indicates the items that were studied on that trial</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># probe_item: this is a vector giving the index of the probe item on each trial</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># response: this is a vector where each value is 2 or 1, depending on whether the participant responsed "yes" (2) or "no" (1) on that trial</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rt: this is a vector of the response times from each trial</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># n_sims: this indicates whether or not simulations are meant to be returned instead of the NLL</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>ebrw_nll <span class="ot">&lt;-</span> <span class="cf">function</span>(par, stim_coords, study_items, probe_item, response, rt, <span class="at">n_sims =</span> <span class="dv">0</span>) {</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Compute the mean and SD of the drift for each trial</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    stim_dists <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(stim_coords))</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    evidence_mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    evidence_sd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        summed_sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span>par[<span class="st">"specificity"</span>] <span class="sc">*</span> stim_dists[probe_item[i], study_items[i,]]))</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> summed_sim <span class="sc">/</span> (summed_sim <span class="sc">+</span> par[<span class="st">"criterion"</span>])</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>        evidence_mean[i] <span class="ot">&lt;-</span> par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> p <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        evidence_sd[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n_sims <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2a. Simulate a response for each trial</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># SIMULATION CODE GOES HERE</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3a. Return final result</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(result)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2b. Calculate the log-likelihood of each observed response/RT on each trial</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">WienerPDF</span>(</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">t =</span> rt,</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">response =</span> response,</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">a =</span> par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_sd,</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">w =</span> par[<span class="st">"w"</span>],</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">v =</span> evidence_mean <span class="sc">/</span> evidence_sd,</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">t0 =</span> par[<span class="st">"t0"</span>]</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3b. Return final result</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">class</span>(result) <span class="sc">==</span> <span class="st">"try-error"</span>) {</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="cn">Inf</span>)</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(result<span class="sc">$</span>logvalue))</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>It is worth pointing out that, aside from the <code>if...else</code> structure, nothing else has changed about the function: Other than <code>n_sims</code> it takes exactly the same arguments, meaning it will still use the provided parameters to compute the drift rates for each trial of an experiment based on the similarity between the studied items and the probe.</p>
<p>You may wonder at this point why <code>n_sims</code> is a number—why didn’t we use a boolean like <code>do_simulation</code> which could be either <code>TRUE</code> or <code>FALSE</code>? This is because we may want to simulate <em>multiple replications</em> of a given trial. For example, we may want to simulate an experiment in which the same study/test items are repeated. Alternatively, we may want to use a large number of simulations so that we can estimate the entire <em>distribution</em> of possible responses and response times that a participant might produce on a given trial. In any case, by allowing <code>n_sims</code> to be a number rather than just <code>TRUE</code> or <code>FALSE</code>, we are making our function more flexible—something for which our future selves will thank our current selves.</p>
<p>Back to the business at hand, we need to fill in the blank where it says <code>SIMULATION CODE HERE</code>. Recall that we are using the <code>WienR</code> package, which includes a <code>sampWiener</code> function for simulating choices and RT’s. We used this to build our diffusion simulation code and we can use it again here. The only challenge is that, unlike <code>WienerPDF</code>, <code>sampWiener</code> can only take a single value for the diffusion model parameters (e.g., <code>a</code>, <code>v</code>, <code>w</code>, etc.) at a time. So we will use a <code>for</code> loop to simulate behavior on each individual trial, as shown in the code below (as usual, there are alternative approaches that are more efficient than a <code>for</code> loop, but our aim at the moment is for transparency):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function arguments:</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par: this is a named vector of parameter values</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stim_coords: this is a matrix of the coordinates of the stimuli, where each row is a stimulus and each column is a dimension</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># study_items: this is a matrix where each row is a trial and each column indicates the items that were studied on that trial</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># probe_item: this is a vector giving the index of the probe item on each trial</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># response: this is a vector where each value is 2 or 1, depending on whether the participant responsed "yes" (2) or "no" (1) on that trial</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rt: this is a vector of the response times from each trial</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># n_sims: this indicates whether or not simulations are meant to be returned instead of the NLL</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>ebrw_nll <span class="ot">&lt;-</span> <span class="cf">function</span>(par, stim_coords, study_items, probe_item, response, rt, <span class="at">n_sims =</span> <span class="dv">0</span>) {</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Compute the mean and SD of the drift for each trial</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    stim_dists <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(stim_coords))</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    evidence_mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    evidence_sd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        summed_sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span>par[<span class="st">"specificity"</span>] <span class="sc">*</span> stim_dists[probe_item[i], study_items[i,]]))</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> summed_sim <span class="sc">/</span> (summed_sim <span class="sc">+</span> par[<span class="st">"criterion"</span>])</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        evidence_mean[i] <span class="ot">&lt;-</span> par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> p <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        evidence_sd[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n_sims <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2a. Simulate a response for each trial</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each trial...</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Simulate `n_sims` replications of this trial, using its corresponding parameters</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>            trial_sim <span class="ot">&lt;-</span> <span class="fu">sampWiener</span>(</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">N =</span> n_sims,</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">a =</span> par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_sd[i],</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">w =</span> par[<span class="st">"w"</span>],</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">v =</span> evidence_mean[i] <span class="sc">/</span> evidence_sd[i],</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">t0 =</span> par[<span class="st">"t0"</span>]</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Append the new set of simulations to our `result`, including an indicator of which trial we are simulating and an index for each simulation</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>            result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>                result,</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>                <span class="fu">tibble</span>(<span class="at">trial =</span> i, <span class="at">sim_index =</span> <span class="dv">1</span><span class="sc">:</span>n_sims, <span class="at">rt =</span> trial_sim<span class="sc">$</span>q, <span class="at">response =</span> trial_sim<span class="sc">$</span>response)</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3a. Return final result</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(result)</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2b. Calculate the log-likelihood of each observed response/RT on each trial</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">WienerPDF</span>(</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>            <span class="at">t =</span> rt,</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>            <span class="at">response =</span> response,</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>            <span class="at">a =</span> par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_sd,</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>            <span class="at">w =</span> par[<span class="st">"w"</span>],</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">v =</span> evidence_mean <span class="sc">/</span> evidence_sd,</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">t0 =</span> par[<span class="st">"t0"</span>]</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3b. Return final result</span></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">class</span>(result) <span class="sc">==</span> <span class="st">"try-error"</span>) {</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="cn">Inf</span>)</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(result<span class="sc">$</span>logvalue))</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code above uses our old trick of creating an “empty” tibble (<code>results &lt;- c()</code>) and then appending each new set of simulations to the <code>results</code> tibble before returning it. Let’s take the new code out for a spin!</p>
<p>First, let’s see how easy it is to simulate data that comes from exactly the same trials that our participant experienced:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sim_trials <span class="ot">&lt;-</span> <span class="fu">ebrw_nll</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> fit<span class="sc">$</span>par,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">stim_coords =</span> stim_coords,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">study_items =</span> study_items,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">probe_item =</span> probe_item,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_sims =</span> <span class="dv">1</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sim_trials)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 28 × 4
   trial sim_index    rt response
   &lt;int&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   
 1     1         1 1.11  lower   
 2     2         1 2.88  lower   
 3     3         1 1.71  upper   
 4     4         1 2.42  upper   
 5     5         1 2.48  upper   
 6     6         1 1.41  upper   
 7     7         1 0.979 upper   
 8     8         1 0.824 lower   
 9     9         1 1.50  lower   
10    10         1 1.26  upper   
# ℹ 18 more rows</code></pre>
</div>
</div>
<p>Notice that for the <code>par</code> argument, we used the fitted parameter values we found earlier, which are in <code>fit$par</code>. We also used the exact same <code>stim_coords</code>, <code>study_items</code>, and <code>probe_item</code> arguments as we used when fitting this participant’s data. So essentially what we just did is simulate an <em>imaginary but plausible</em> dataset that this participant <em>could have</em> produced, assuming that the EBRW is a good model of their performance.</p>
<p>While simulating a single dataset has its value—like with the parameter recovery exercises we did with diffusion models—we might be more interested in the <em>distribution</em> of responses and response times that this participant might produce. This is one reason why it is handy to be able to set <code>n_sims</code> to a large value, as in the chunk of code below. We can then estimate, for example, the <em>probability</em> of making a “yes” response in a particular trial, or the <em>mean</em> correct response time. That said, the next section will show us how we can obtain predictions for response probabilities and mean RT’s mathematically. However, mathematical formulae won’t always be available, so we will often fall back on simulations.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate many trials</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>sim_trials <span class="ot">&lt;-</span> <span class="fu">ebrw_nll</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> fit<span class="sc">$</span>par,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">stim_coords =</span> stim_coords,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">study_items =</span> study_items,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">probe_item =</span> probe_item,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_sims =</span> <span class="dv">1000</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain mean predictions for each trial</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>sim_means <span class="ot">&lt;-</span> sim_trials <span class="sc">%&gt;%</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(trial) <span class="sc">%&gt;%</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">sim_p_upper =</span> <span class="fu">mean</span>(response <span class="sc">==</span> <span class="st">"upper"</span>),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">sim_mean_rt_yes =</span> <span class="fu">mean</span>(rt[response <span class="sc">==</span> <span class="st">"upper"</span>]),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">sim_mean_rt_no =</span> <span class="fu">mean</span>(rt[response <span class="sc">==</span> <span class="st">"lower"</span>])</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sim_means)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 28 × 4
   trial sim_p_upper sim_mean_rt_yes sim_mean_rt_no
   &lt;int&gt;       &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;
 1     1       0.001            1.37           1.63
 2     2       0.041            1.95           1.72
 3     3       0.991            1.86           1.38
 4     4       0.986            1.84           1.57
 5     5       0.989            1.87           2.00
 6     6       0.994            1.88           1.97
 7     7       0.993            1.81           1.44
 8     8       0.028            1.94           1.72
 9     9       0              NaN              1.52
10    10       0.988            1.81           1.77
# ℹ 18 more rows</code></pre>
</div>
</div>
<p>You may already notice one issue with using simulation to obtain average model predictions. According to the fitted model, there is almost no chance that this participant gives a “yes” response on trial 9. Even in 1000 simulations, the model never produced a “yes” response on that trial. As a result, we would need to simulate <em>many</em> trials before we got a stable estimate of the mean RT for a “yes” response on the trial (though, given how unlikely it is, maybe we wouldn’t be too interested in that prediction anyway).</p>
<p>Out of curiousity, let’s see what the study items and probe were for trial 9:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>study_items[<span class="dv">9</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>probe_item[<span class="dv">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>If you refer back to the MDS plot above, we see that items 3 and 4 (the studied items on trial 9) both fall on one end of “Dimension 1” whereas item 6 (the probe item) falls on the other side. In other words, the probe is pretty far from <em>both</em> studied items, so it makes sense that the EBRW would predict a very low probability that this participant incorrectly says “yes” on that trial.</p>
</section>
<section id="mathematical-expressions-for-response-probability-and-mean-rts" class="level3" data-number="9.5.2">
<h3 data-number="9.5.2" class="anchored" data-anchor-id="mathematical-expressions-for-response-probability-and-mean-rts"><span class="header-section-number">9.5.2</span> Mathematical expressions for response probability and mean RT’s</h3>
<p>Many cognitive models are sufficiently complex that there aren’t mathematical expressions for their predictions. However, the Wiener diffusion model (i.e., without any extra trial-by-trial variability) actually has mathematical expressions for the mean response probability and mean response times (for each response). These formulae aren’t exactly pretty, but they only involve elementary functions that are built into R, so we can translate them into code.</p>
<p><span class="math display">\[\begin{align}
\hat{p}_i &amp; = \frac{1 - \exp \left( -\frac{2 a v_i w}{s_i^2} \right)}{1 - \exp\left(-\frac{2 a v_i}{s_i^2} \right)} \\
\widehat{RT}_{Y,i} &amp; = t_0 + \frac{a}{v_i} \left[ \frac{1}{\tanh \left( \frac{a v_i}{s_i^2} \right)} - \frac{w}{\tanh \left( \frac{a v_i w}{s_i^2} \right)} \right] \\
\widehat{RT}_{N,i} &amp; = t_0 + \frac{a}{v_i} \left[ \frac{1}{\tanh \left( \frac{a v_i}{s_i^2} \right)} - \frac{1 - w}{\tanh \left( \frac{a v_i \left(1 - w \right)}{s_i^2} \right)} \right]
\end{align}\]</span></p>
<p>It may help to keep in mind the following “Rosetta stone” that relates the mathematical notation to things that we recognize from our code:</p>
<ul>
<li><span class="math inline">\(\hat{p}_i\)</span>: Probability of giving a “yes” response on trial <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\widehat{RT}_{Y,i}\)</span>: Mean RT for “yes” responses on trial <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\widehat{RT}_{N,i}\)</span>: Mean RT for “no” responses on trial <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(a\)</span>: Boundary separation, <code>par["a"]</code>.</li>
<li><span class="math inline">\(w\)</span>: Response bias, <code>par["w"]</code>.</li>
<li><span class="math inline">\(t_0\)</span>: Residual time, <code>par["t0"]</code>.</li>
<li><span class="math inline">\(v_i\)</span>: Mean drift rate on trial <span class="math inline">\(i\)</span>, <code>evidence_mean[i]</code>.</li>
<li><span class="math inline">\(s_i\)</span>: Standard deviation of drift on trial <span class="math inline">\(i\)</span>, <code>evidence_sd[i]</code>.</li>
</ul>
<p>Finally, <span class="math inline">\(\tanh\)</span> is the <a href="https://en.wikipedia.org/wiki/Hyperbolic_functions#Hyperbolic_tangent">hyperbolic tangent</a> function, which is built into R as <code>tanh()</code>. This function is defined by <span class="math display">\[
\tanh \left(x \right) = \frac{\exp \left( x \right) - \exp \left(-x \right)}{\exp \left( x \right) + \exp \left(-x \right)}
\]</span> and it looks like this:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">201</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">tanh</span>(x)) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"tanh(x)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ebrw_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Armed with these mathematical expressions, we can readily translate them into R code. We’ll first do that and then see how we can insert that code into our <code>ebrw_nll</code> function. In the following, we are again using a <code>for</code> loop over each trial, using <code>i</code> as the index for the trial. Like we did with the simulations, we will first create an empty <code>result</code> and then append the predicted response probabilities and mean RT’s for each trial. Also, since the term <span class="math inline">\(s_i^2\)</span> appears many times across all three formulae, we will want to compute it once and then refer back to it again later. The result is stored as the vector <code>evidence_var</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For convenience, we compute this first so we can refer to it each time we need it later</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>evidence_var <span class="ot">&lt;-</span> evidence_sd<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    trial_p_yes <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">*</span> par[<span class="st">"w"</span>] <span class="sc">/</span> evidence_var[i])) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">/</span> evidence_var[i]))</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    trial_mean_rt_yes <span class="ot">&lt;-</span> par[<span class="st">"t0"</span>] <span class="sc">+</span> (par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_mean[i]) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">/</span> evidence_var[i]) <span class="sc">-</span> par[<span class="st">"w"</span>] <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">*</span> par[<span class="st">"w"</span>] <span class="sc">/</span> evidence_var[i]))</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    trial_mean_rt_no <span class="ot">&lt;-</span> par[<span class="st">"t0"</span>] <span class="sc">+</span> (par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_mean[i]) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">/</span> evidence_var[i]) <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> par[<span class="st">"w"</span>]) <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> par[<span class="st">"w"</span>]) <span class="sc">/</span> evidence_var[i]))</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>        result,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tibble</span>(<span class="at">trial =</span> i, <span class="at">p_yes =</span> trial_p_yes, <span class="at">mean_rt_yes =</span> trial_mean_rt_yes, <span class="at">mean_rt_no =</span> trial_mean_rt_no)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now we just need to figure out how to get the chunk of code above into our <code>ebrw_nll</code> function. There are a number of reasonable ways to do this. For example, we could add a new argument called something like <code>return_math_pred</code> which we could set to be <code>TRUE</code> or <code>FALSE</code> depending on whether we wanted the mathematically-computed mean predictions. However, since we already have the <code>n_sims</code> argument we added earlier, we can do something a bit clever. Since the mean predictions are based on what we would observe over an infinite number of simulations, we can allow a user to set <code>n_sims = Inf</code>, where <code>Inf</code> is R’s special shorthand for “infinity”. R uses the <code>is.infinite</code> function to check whether a number is infinite or not.</p>
<p>As such, in the code below, we “daisy-chain” the <code>if...else</code> construction we built in the previous section. We first check <code>if (is.infinite(n_sims))</code> and, if so, run the chunk of code above. We then check for <code>else if (n_sims &gt; 0)</code> and, if so, run the specified but finite number of simulations per trial. Finally, the <code>else</code> statement computes the negative log-likelihoods.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function arguments:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par: this is a named vector of parameter values</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stim_coords: this is a matrix of the coordinates of the stimuli, where each row is a stimulus and each column is a dimension</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># study_items: this is a matrix where each row is a trial and each column indicates the items that were studied on that trial</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># probe_item: this is a vector giving the index of the probe item on each trial</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># response: this is a vector where each value is 2 or 1, depending on whether the participant responsed "yes" (2) or "no" (1) on that trial</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rt: this is a vector of the response times from each trial</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># n_sims: this indicates whether or not simulations are meant to be returned instead of the NLL</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>ebrw_nll <span class="ot">&lt;-</span> <span class="cf">function</span>(par, stim_coords, study_items, probe_item, response, rt, <span class="at">n_sims =</span> <span class="dv">0</span>) {</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Compute the mean and SD of the drift for each trial</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    stim_dists <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(stim_coords))</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    evidence_mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    evidence_sd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>        summed_sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span>par[<span class="st">"specificity"</span>] <span class="sc">*</span> stim_dists[probe_item[i], study_items[i,]]))</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> summed_sim <span class="sc">/</span> (summed_sim <span class="sc">+</span> par[<span class="st">"criterion"</span>])</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>        evidence_mean[i] <span class="ot">&lt;-</span> par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> p <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>        evidence_sd[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.infinite</span>(n_sims)) {</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2a. Compute predicted response probabilities and mean RT's for each trial</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>        evidence_var <span class="ot">&lt;-</span> evidence_sd<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>            trial_p_yes <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">*</span> par[<span class="st">"w"</span>] <span class="sc">/</span> evidence_var[i])) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">/</span> evidence_var[i]))</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>            trial_mean_rt_yes <span class="ot">&lt;-</span> par[<span class="st">"t0"</span>] <span class="sc">+</span> (par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_mean[i]) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">/</span> evidence_var[i]) <span class="sc">-</span> par[<span class="st">"w"</span>] <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">*</span> par[<span class="st">"w"</span>] <span class="sc">/</span> evidence_var[i]))</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>            trial_mean_rt_no <span class="ot">&lt;-</span> par[<span class="st">"t0"</span>] <span class="sc">+</span> (par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_mean[i]) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">/</span> evidence_var[i]) <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> par[<span class="st">"w"</span>]) <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> par[<span class="st">"w"</span>]) <span class="sc">/</span> evidence_var[i]))</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>            result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>                result,</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>                <span class="fu">tibble</span>(<span class="at">trial =</span> i, <span class="at">p_yes =</span> trial_p_yes, <span class="at">mean_rt_yes =</span> trial_mean_rt_yes, <span class="at">mean_rt_no =</span> trial_mean_rt_no)</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3a. Return final result</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(result)</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (n_sims <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2b. Simulate a response for each trial</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each trial...</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Simulate `n_sims` replications of this trial, using its corresponding parameters</span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>            trial_sim <span class="ot">&lt;-</span> <span class="fu">sampWiener</span>(</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">N =</span> n_sims,</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>                <span class="at">a =</span> par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_sd[i],</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>                <span class="at">w =</span> par[<span class="st">"w"</span>],</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>                <span class="at">v =</span> evidence_mean[i] <span class="sc">/</span> evidence_sd[i],</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>                <span class="at">t0 =</span> par[<span class="st">"t0"</span>]</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Append the new set of simulations to our `result`, including an indicator of which trial we are simulating and an index for each simulation</span></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>            result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>                result,</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>                <span class="fu">tibble</span>(<span class="at">trial =</span> i, <span class="at">sim_index =</span> <span class="dv">1</span><span class="sc">:</span>n_sims, <span class="at">rt =</span> trial_sim<span class="sc">$</span>q, <span class="at">response =</span> trial_sim<span class="sc">$</span>response)</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3b. Return final result</span></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(result)</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2c. Calculate the log-likelihood of each observed response/RT on each trial</span></span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">WienerPDF</span>(</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">t =</span> rt,</span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">response =</span> response,</span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>            <span class="at">a =</span> par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_sd,</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>            <span class="at">w =</span> par[<span class="st">"w"</span>],</span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">v =</span> evidence_mean <span class="sc">/</span> evidence_sd,</span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>            <span class="at">t0 =</span> par[<span class="st">"t0"</span>]</span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3c. Return final result</span></span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">class</span>(result) <span class="sc">==</span> <span class="st">"try-error"</span>) {</span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="cn">Inf</span>)</span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(result<span class="sc">$</span>logvalue))</span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Again, let’s see how this works. The code below computes the predicted mean response probabilities and RT’s for each trial:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>math_pred <span class="ot">&lt;-</span> <span class="fu">ebrw_nll</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> fit<span class="sc">$</span>par,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">stim_coords =</span> stim_coords,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">study_items =</span> study_items,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">probe_item =</span> probe_item,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_sims =</span> <span class="cn">Inf</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>math_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 28 × 4
   trial       p_yes mean_rt_yes mean_rt_no
   &lt;int&gt;       &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
 1     1 0.00420            1.84       1.64
 2     2 0.0359             1.89       1.70
 3     3 0.990              1.84       1.63
 4     4 0.990              1.84       1.63
 5     5 0.991              1.83       1.63
 6     6 0.990              1.84       1.63
 7     7 0.990              1.84       1.63
 8     8 0.0364             1.89       1.70
 9     9 0.000000120        1.71       1.52
10    10 0.992              1.83       1.62
# ℹ 18 more rows</code></pre>
</div>
</div>
<p>Let’s see how the mathematical predictions compare to those we derived from our 1000 simulations earlier, at least for the first few trials:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">full_join</span>(sim_means, math_pred, <span class="at">by =</span> <span class="st">"trial"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,], <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 15%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">trial</th>
<th style="text-align: right;">sim_p_upper</th>
<th style="text-align: right;">sim_mean_rt_yes</th>
<th style="text-align: right;">sim_mean_rt_no</th>
<th style="text-align: right;">p_yes</th>
<th style="text-align: right;">mean_rt_yes</th>
<th style="text-align: right;">mean_rt_no</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.367</td>
<td style="text-align: right;">1.629</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">1.842</td>
<td style="text-align: right;">1.636</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">1.948</td>
<td style="text-align: right;">1.721</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">1.888</td>
<td style="text-align: right;">1.695</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.991</td>
<td style="text-align: right;">1.861</td>
<td style="text-align: right;">1.384</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;">1.836</td>
<td style="text-align: right;">1.631</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.986</td>
<td style="text-align: right;">1.839</td>
<td style="text-align: right;">1.572</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;">1.836</td>
<td style="text-align: right;">1.630</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.989</td>
<td style="text-align: right;">1.867</td>
<td style="text-align: right;">2.003</td>
<td style="text-align: right;">0.991</td>
<td style="text-align: right;">1.833</td>
<td style="text-align: right;">1.628</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.994</td>
<td style="text-align: right;">1.875</td>
<td style="text-align: right;">1.967</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;">1.836</td>
<td style="text-align: right;">1.631</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.993</td>
<td style="text-align: right;">1.807</td>
<td style="text-align: right;">1.444</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;">1.835</td>
<td style="text-align: right;">1.629</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">1.938</td>
<td style="text-align: right;">1.725</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">1.888</td>
<td style="text-align: right;">1.695</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: right;">1.521</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.710</td>
<td style="text-align: right;">1.520</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">1.807</td>
<td style="text-align: right;">1.765</td>
<td style="text-align: right;">0.992</td>
<td style="text-align: right;">1.830</td>
<td style="text-align: right;">1.625</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.989</td>
<td style="text-align: right;">1.807</td>
<td style="text-align: right;">1.597</td>
<td style="text-align: right;">0.992</td>
<td style="text-align: right;">1.831</td>
<td style="text-align: right;">1.625</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.991</td>
<td style="text-align: right;">1.809</td>
<td style="text-align: right;">1.789</td>
<td style="text-align: right;">0.992</td>
<td style="text-align: right;">1.831</td>
<td style="text-align: right;">1.625</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As we can see, the simulated means tend to be close to the mathematical predictions, but can be off when it comes to predicting mean RT’s for rare responses, since those predictions are based on only a few simulated trials.</p>
</section>
<section id="comparing-predicted-to-observed" class="level3" data-number="9.5.3">
<h3 data-number="9.5.3" class="anchored" data-anchor-id="comparing-predicted-to-observed"><span class="header-section-number">9.5.3</span> Comparing predicted to observed</h3>
<p>As noted above, being able to compute predictions from the EBRW is important to verify that it is doing a good job fitting the data. A common way to do this is to make a plot with observed values on the horizontal axis and predicted value on the vertical axis. To the extent that the points in the plot cluster around the diagonal, we have reason to believe that the model’s predictions are closely aligned with what was observed. Relatedly, we can report the <span class="math inline">\(R^2\)</span> value, i.e., the proportion of variance explained by the model; this is just the square of the Pearson correlation coefficient.</p>
<p>In the present application, we have two observed values on each trial: the response and the RT. Thus, we’ll need to make two plots, one for each measure. But to do that, we’ll first need to get both the observed and predicted data into the same data structure. That’s what the chunk of code below does.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This tibble contains the observed data for each trial</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>obs_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">rt =</span> rt,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">response =</span> response <span class="sc">-</span> <span class="dv">1</span> <span class="co"># The "- 1" is because "response" is coded as 2 ("yes") and 1 ("no"), but it'll be easier to instead code this as 1 ("yes") and 0 ("no").</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Since both the observed and predicted data contain a "trial" column, use that to join them together</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>obs_pred <span class="ot">&lt;-</span> <span class="fu">full_join</span>(obs_data, math_pred, <span class="at">by =</span> <span class="st">"trial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now let’s try to naively plot the observed and predicted data against one another, as we just described. Note that this will not really work as intended!</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>resp_plot <span class="ot">&lt;-</span> obs_pred <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> response, <span class="at">y =</span> p_yes, <span class="at">color =</span> <span class="fu">factor</span>(response))) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#377eb8"</span>, <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"#e41a1c"</span>)) <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observed response"</span>, <span class="at">y =</span> <span class="st">"Predicted P(</span><span class="sc">\"</span><span class="st">Yes</span><span class="sc">\"</span><span class="st">)"</span>, <span class="at">color =</span> <span class="st">"Response"</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>rt_plot <span class="ot">&lt;-</span> obs_pred <span class="sc">%&gt;%</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pred_rt =</span> <span class="fu">if_else</span>(response <span class="sc">==</span> <span class="dv">1</span>, mean_rt_yes, mean_rt_no)) <span class="sc">%&gt;%</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rt, <span class="at">y =</span> pred_rt, <span class="at">color =</span> <span class="fu">factor</span>(response))) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#377eb8"</span>, <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"#e41a1c"</span>)) <span class="sc">+</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observed RT"</span>, <span class="at">y =</span> <span class="st">"Predicted mean RT"</span>, <span class="at">color =</span> <span class="st">"Response"</span>)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>resp_plot <span class="sc">+</span> rt_plot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ebrw_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the plots above, each point represents a single trial. While we can see in the left plot (barely) that the model generally tends to predict a high probability of saying “yes” on trials where the participant actually said “yes”, it is much harder to see what is going on in the right plot that shows RT’s. The issue is that the model is making a prediction about the <em>mean</em> RT whereas each point represents a <em>sample</em> from the participant’s RT distribution.</p>
<p>Therefore, a more informative way to judge whether the model is making sensible predictions is to compare its <em>mean</em> predictions against <em>average</em> observed performance. Since this is a recognition memory task, it makes the most sense to average performance depending on whether the probe item was a <em>target</em> (i.e., was one of the studied items) or a <em>foil</em> (i.e., was not one of the studied items). The code below first defines a new column in the <code>obs_pred</code> tibble that indicates the type of trial before aggregating both observed and predicted performance by probe type, then making plots similar to those above.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>obs_pred<span class="sc">$</span>probe_type <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note the use of "%in%"</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (probe_item[i] <span class="sc">%in%</span> study_items[i,]) {</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        obs_pred<span class="sc">$</span>probe_type[i] <span class="ot">&lt;-</span> <span class="st">"Target"</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>        obs_pred<span class="sc">$</span>probe_type[i] <span class="ot">&lt;-</span> <span class="st">"Foil"</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>obs_pred<span class="sc">$</span>probe_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(obs_pred<span class="sc">$</span>probe_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Target"</span>, <span class="st">"Foil"</span>))</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>resp_plot <span class="ot">&lt;-</span> obs_pred <span class="sc">%&gt;%</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(probe_type) <span class="sc">%&gt;%</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean_obs =</span> <span class="fu">mean</span>(response), <span class="at">mean_pred =</span> <span class="fu">mean</span>(p_yes)) <span class="sc">%&gt;%</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_obs, <span class="at">y =</span> mean_pred, <span class="at">color =</span> probe_type)) <span class="sc">+</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Target"</span> <span class="ot">=</span> <span class="st">"#377eb8"</span>, <span class="st">"Foil"</span> <span class="ot">=</span> <span class="st">"#e41a1c"</span>)) <span class="sc">+</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observed response proportion"</span>, <span class="at">y =</span> <span class="st">"Predicted P(</span><span class="sc">\"</span><span class="st">Yes</span><span class="sc">\"</span><span class="st">)"</span>, <span class="at">color =</span> <span class="cn">NULL</span>)</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>rt_plot <span class="ot">&lt;-</span> obs_pred <span class="sc">%&gt;%</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pred_rt =</span> <span class="fu">if_else</span>(response <span class="sc">==</span> <span class="dv">1</span>, mean_rt_yes, mean_rt_no)) <span class="sc">%&gt;%</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(probe_type) <span class="sc">%&gt;%</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean_obs =</span> <span class="fu">mean</span>(rt), <span class="at">mean_pred =</span> <span class="fu">mean</span>(pred_rt)) <span class="sc">%&gt;%</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_obs, <span class="at">y =</span> mean_pred, <span class="at">color =</span> probe_type)) <span class="sc">+</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Target"</span> <span class="ot">=</span> <span class="st">"#377eb8"</span>, <span class="st">"Foil"</span> <span class="ot">=</span> <span class="st">"#e41a1c"</span>)) <span class="sc">+</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observed mean RT"</span>, <span class="at">y =</span> <span class="st">"Predicted mean RT"</span>, <span class="at">color =</span> <span class="cn">NULL</span>)</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>resp_plot <span class="sc">+</span> rt_plot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ebrw_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The above graphs are not only easier to see, they allow us to more fairly critique the model. The model does a great job predicting response probabilities as well as mean RT for targets. It looks like it predicts longer mean RT to foils than was observed, but that could also reflect sampling variability. In general, the plots above suggest that the model is generally good at fitting this participant’s data, though it may be missing something about the RT’s. That misfit in part justifies the more complex version of the EBRW that <span class="citation" data-cites="GillespieCox2024">Gillespie &amp; Cox (<a href="references.html#ref-GillespieCox2024" role="doc-biblioref">2024</a>)</span> fit to these data.</p>
</section>
<section id="making-novel-predictions" class="level3" data-number="9.5.4">
<h3 data-number="9.5.4" class="anchored" data-anchor-id="making-novel-predictions"><span class="header-section-number">9.5.4</span> Making novel predictions</h3>
<p>Now that we have the ability to quickly extract predictions from the EBRW, it is worth pointing out that we can now make predictions about how this participant would respond in a trial they did not experience, perhaps with a different set of study items or a different probe item.</p>
<p>To go even broader, we could imagine a new experiment in which the auditory stimuli were degraded by noise. In that case, we might expect the participant’s sensitivity parameter to be lower in that condition. We could simulate how this would affect their recognition performance with this stimuli (though it is likely that, in such an experiment, the participant would also adjust their response caution and response bias to compensate).</p>
<p>The point is that the EBRW permits us to make predictions regarding particular experimental manipulations, which can then help us design future experiments. This is because the EBRW’s predictions depend upon the specifics of how a participant represents the items in the experiment and contains parameters with meanings that are clearly linked to cognitive constructs like “sensitivity”. This was not necessarily the case with the “generic” decision models we explored earlier in the course.</p>
</section>
</section>
<section id="putting-it-all-together" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="putting-it-all-together"><span class="header-section-number">9.6</span> Putting it all together</h2>
<p>The chunk of code below puts all our EBRW work in one place. There are blanks left in certain areas that could either be filled by observed results or by your own imagination. In addition, a complete script that simulates data using the EBRW, fits the EBRW to the simulated data, and compares the simulated to the fitted data is provided <a href="https://raw.githubusercontent.com/gregcox7/cogmod/refs/heads/main/ebrw_sim_fit_example.r">here</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This could be derived using MDS</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>stim_coords <span class="ot">&lt;-</span> ...</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># These could be actual trials in an experiment or used to construct imaginary trials for simulation</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>study_items <span class="ot">&lt;-</span> ...</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>probe_item <span class="ot">&lt;-</span> ...</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># These could be observed or simulated; they may not even be needed if you are just doing simulation</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> ...</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>rt <span class="ot">&lt;-</span> ...</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># This could be from a model fit or specified manually to do simulations</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>par <span class="ot">&lt;-</span> ...</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Function arguments:</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co"># par: this is a named vector of parameter values</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co"># stim_coords: this is a matrix of the coordinates of the stimuli, where each row is a stimulus and each column is a dimension</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co"># study_items: this is a matrix where each row is a trial and each column indicates the items that were studied on that trial</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="co"># probe_item: this is a vector giving the index of the probe item on each trial</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co"># response: this is a vector where each value is 2 or 1, depending on whether the participant responsed "yes" (2) or "no" (1) on that trial</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co"># rt: this is a vector of the response times from each trial</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="co"># n_sims: this indicates whether or not simulations are meant to be returned instead of the NLL</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>ebrw_nll <span class="ot">&lt;-</span> <span class="cf">function</span>(par, stim_coords, study_items, probe_item, response, rt, <span class="at">n_sims =</span> <span class="dv">0</span>) {</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Compute the mean and SD of the drift for each trial</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>    stim_dists <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(stim_coords))</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    evidence_mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>    evidence_sd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(probe_item))</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>        summed_sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span>par[<span class="st">"specificity"</span>] <span class="sc">*</span> stim_dists[probe_item[i], study_items[i,]]))</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> summed_sim <span class="sc">/</span> (summed_sim <span class="sc">+</span> par[<span class="st">"criterion"</span>])</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>        evidence_mean[i] <span class="ot">&lt;-</span> par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> p <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>        evidence_sd[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.infinite</span>(n_sims)) {</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2a. Compute predicted response probabilities and mean RT's for each trial</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>        evidence_var <span class="ot">&lt;-</span> evidence_sd<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>            trial_p_yes <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">*</span> par[<span class="st">"w"</span>] <span class="sc">/</span> evidence_var[i])) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">/</span> evidence_var[i]))</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>            trial_mean_rt_yes <span class="ot">&lt;-</span> par[<span class="st">"t0"</span>] <span class="sc">+</span> (par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_mean[i]) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">/</span> evidence_var[i]) <span class="sc">-</span> par[<span class="st">"w"</span>] <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">*</span> par[<span class="st">"w"</span>] <span class="sc">/</span> evidence_var[i]))</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>            trial_mean_rt_no <span class="ot">&lt;-</span> par[<span class="st">"t0"</span>] <span class="sc">+</span> (par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_mean[i]) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">/</span> evidence_var[i]) <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> par[<span class="st">"w"</span>]) <span class="sc">/</span> <span class="fu">tanh</span>(par[<span class="st">"a"</span>] <span class="sc">*</span> evidence_mean[i] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> par[<span class="st">"w"</span>]) <span class="sc">/</span> evidence_var[i]))</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>            result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>                result,</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>                <span class="fu">tibble</span>(<span class="at">trial =</span> i, <span class="at">p_yes =</span> trial_p_yes, <span class="at">mean_rt_yes =</span> trial_mean_rt_yes, <span class="at">mean_rt_no =</span> trial_mean_rt_no)</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3a. Return final result</span></span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(result)</span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (n_sims <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2b. Simulate a response for each trial</span></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each trial...</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Simulate `n_sims` replications of this trial, using its corresponding parameters</span></span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a>            trial_sim <span class="ot">&lt;-</span> <span class="fu">sampWiener</span>(</span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a>                <span class="at">N =</span> n_sims,</span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a>                <span class="at">a =</span> par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_sd[i],</span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a>                <span class="at">w =</span> par[<span class="st">"w"</span>],</span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a>                <span class="at">v =</span> evidence_mean[i] <span class="sc">/</span> evidence_sd[i],</span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a>                <span class="at">t0 =</span> par[<span class="st">"t0"</span>]</span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Append the new set of simulations to our `result`, including an indicator of which trial we are simulating and an index for each simulation</span></span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a>            result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a>                result,</span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a>                <span class="fu">tibble</span>(<span class="at">trial =</span> i, <span class="at">sim_index =</span> <span class="dv">1</span><span class="sc">:</span>n_sims, <span class="at">rt =</span> trial_sim<span class="sc">$</span>q, <span class="at">response =</span> trial_sim<span class="sc">$</span>response)</span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb51-79"><a href="#cb51-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-80"><a href="#cb51-80" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3b. Return final result</span></span>
<span id="cb51-81"><a href="#cb51-81" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(result)</span>
<span id="cb51-82"><a href="#cb51-82" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb51-83"><a href="#cb51-83" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2c. Calculate the log-likelihood of each observed response/RT on each trial</span></span>
<span id="cb51-84"><a href="#cb51-84" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">WienerPDF</span>(</span>
<span id="cb51-85"><a href="#cb51-85" aria-hidden="true" tabindex="-1"></a>            <span class="at">t =</span> rt,</span>
<span id="cb51-86"><a href="#cb51-86" aria-hidden="true" tabindex="-1"></a>            <span class="at">response =</span> response,</span>
<span id="cb51-87"><a href="#cb51-87" aria-hidden="true" tabindex="-1"></a>            <span class="at">a =</span> par[<span class="st">"a"</span>] <span class="sc">/</span> evidence_sd,</span>
<span id="cb51-88"><a href="#cb51-88" aria-hidden="true" tabindex="-1"></a>            <span class="at">w =</span> par[<span class="st">"w"</span>],</span>
<span id="cb51-89"><a href="#cb51-89" aria-hidden="true" tabindex="-1"></a>            <span class="at">v =</span> evidence_mean <span class="sc">/</span> evidence_sd,</span>
<span id="cb51-90"><a href="#cb51-90" aria-hidden="true" tabindex="-1"></a>            <span class="at">t0 =</span> par[<span class="st">"t0"</span>]</span>
<span id="cb51-91"><a href="#cb51-91" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb51-92"><a href="#cb51-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-93"><a href="#cb51-93" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3c. Return final result</span></span>
<span id="cb51-94"><a href="#cb51-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">class</span>(result) <span class="sc">==</span> <span class="st">"try-error"</span>) {</span>
<span id="cb51-95"><a href="#cb51-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="cn">Inf</span>)</span>
<span id="cb51-96"><a href="#cb51-96" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb51-97"><a href="#cb51-97" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(result<span class="sc">$</span>logvalue))</span>
<span id="cb51-98"><a href="#cb51-98" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb51-99"><a href="#cb51-99" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-100"><a href="#cb51-100" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercises" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="exercises"><span class="header-section-number">9.7</span> Exercises</h2>
<ol type="1">
<li>This exercise makes use of <a href="https://raw.githubusercontent.com/gregcox7/cogmod/refs/heads/main/ebrw_sim_fit_example.r">the EBRW example script</a> mentioned in the main text. It replicates the recognition memory task described in the chapter, assuming two items per study list followed by a single probe item. With this script, you can specify <code>stim_coords</code> and, by default, it will simulate one trial for each possible combination of study items and probe item (i.e., all possible 2-item lists, followed by all possible probe items). The script then fits the EBRW to the simulated data using exactly the same code as in the chapter. Finally, the script also produces plots of predicted vs.&nbsp;observed performance just like in the chapter.
<ol type="a">
<li>Replace the <code>stim_coords</code> matrix in the example file with one of your own devising. As a reminder, each row should correspond to a different item with each column giving its coordinate along the corresponding dimension. You might define your <code>stim_coords</code> based on pre-existing knowledge of psychologically-relevant stimulus dimensions (like with the color example at the beginning of the chapter). You could also find a matrix of coordinates obtained from a published scaling study, or one you carry out yourself. Finally, you could come up with <code>stim_coords</code> that represent a meaningful hypothesis about how some set of items is represented psychologically. In any case, provide your matrix and explain what the items are and what each dimension is.</li>
<li>Modify the simulation parameters in <code>sim_par</code> until the model’s simulated performance resembles what you would expect to see in a real experiment using your stimuli.</li>
<li>Describe an experimental manipulation that you expect would influence the EBRW’s sensitivity parameter. Simulate performance using a lower value of the sensitivity parameter than you used in part (b) and comment on how the model’s predicted performance is affected.</li>
<li>Find values for the <em>other</em> parameters in the model (e.g., boundary separation, drift bias) that allow it to achieve the same speed and accuracy with lower sensitivity (part c) as it achieved with higher sensitivity (part d).</li>
</ol></li>
<li>You may have noticed that our implementation of the EBRW assumes that each list of studied items is the same length. Describe how to modify our <code>ebrw_nll</code> function so that <code>study_items</code> can include <code>NA</code> values, thus allowing for lists to vary in length, similar to how we allowed our race model to be robust to sets of different size. <em>Hint: All this involves is putting a <code>na.rm = TRUE</code> somewhere in our code!</em></li>
<li>This is a follow-up to the previous exercise. In applications of the EBRW to experiments that vary the number of items, it is typical to assume that the “criterion” varies linearly with list length <span class="citation" data-cites="NosofskyEtAl2011 NosofskyEtAl2014">(<a href="references.html#ref-NosofskyEtAl2011" role="doc-biblioref">Nosofsky et al., 2011</a>, <a href="references.html#ref-NosofskyEtAl2014" role="doc-biblioref">2014</a>)</span>. Modify our <code>ebrw_nll</code> function to accommodate this version of the model. The chunk of code below gives a suggestion about how this might be done in such a way that preserves the functionality of the code we used throughout this chapter by keeping the “criterion” parameter and adding a “criterion_slope” parameter.</li>
</ol>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>ebrw_nll <span class="ot">&lt;-</span> <span class="cf">function</span>(par, stim_coords, study_items, probe_item, response, rt, <span class="at">n_sims =</span> <span class="dv">0</span>) {</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(par[<span class="st">"criterion_slope"</span>])) {</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        criterion_slope <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>        criterion_slope <span class="ot">&lt;-</span> par[<span class="st">"criterion_slope"</span>]</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probe_item)) {</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>        summed_sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span>par[<span class="st">"specificity"</span>] <span class="sc">*</span> stim_dists[probe_item[i], study_items[i,]]))</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># HINT: You will need to find the value of `list_length` on each trial---how will you do this?  (You might think about the fact that we are using `NA` values to indicate when `study_items[i,]` has fewer items than the number of columns in `study_items`).</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>        this_criterion <span class="ot">&lt;-</span> par[<span class="st">"criterion"</span>] <span class="sc">+</span> criterion_slope <span class="sc">*</span> list_length</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> summed_sim <span class="sc">/</span> (summed_sim <span class="sc">+</span> this_criterion)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>        evidence_mean[i] <span class="ot">&lt;-</span> par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> p <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>        evidence_sd[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(par[<span class="st">"retrieval_rate"</span>] <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-GarnerFelfoldy1970" class="csl-entry" role="listitem">
Garner, W. R., &amp; Felfoldy, G. L. (1970). Integrality of stimulus dimensions in various types of information processing. <em>Cognitive Psychology</em>, <em>1</em>, 225–241.
</div>
<div id="ref-GillespieCox2024" class="csl-entry" role="listitem">
Gillespie, N. F., &amp; Cox, G. E. (2024). <em>Perception and memory for novel auditory stimuli: Similarity, serial position, and list homogeneity</em>. PsyArXiv. <a href="https://doi.org/10.31234/osf.io/n294a">https://doi.org/10.31234/osf.io/n294a</a>
</div>
<div id="ref-Nosofsky1986" class="csl-entry" role="listitem">
Nosofsky, R. M. (1986). Attention, similarity, and the identification-categorization relationship. <em>Journal of Experimental Psychology: General</em>, <em>115</em>(1), 39–57.
</div>
<div id="ref-Nosofsky1992" class="csl-entry" role="listitem">
Nosofsky, R. M. (1992). Similarity scaling and cognitive process models. <em>Annual Review of Psychology</em>, <em>43</em>, 25–53.
</div>
<div id="ref-NosofskyEtAl2014" class="csl-entry" role="listitem">
Nosofsky, R. M., Cox, G. E., Cao, R., &amp; Shiffrin, R. M. (2014). An exemplar-familiarity model predicts short-term and long-term probe recognition across diverse forms of memory search. <em>Journal of Experimental Psychology: Learning, Memory, and Cognition</em>, <em>40</em>(6), 1524–1539.
</div>
<div id="ref-NosofskyEtAl2011" class="csl-entry" role="listitem">
Nosofsky, R. M., Little, D. R., Donkin, C., &amp; Fific, M. (2011). Short-term memory scanning viewed as exemplar-based categorization. <em>Psychological Review</em>, <em>118</em>(2), 280–315.
</div>
<div id="ref-NosofskyPalmeri1997" class="csl-entry" role="listitem">
Nosofsky, R. M., &amp; Palmeri, T. J. (1997). An exemplar-based random walk model of speeded classification. <em>Psychological Review</em>, <em>104</em>(2), 266–300.
</div>
<div id="ref-Shepard1962a" class="csl-entry" role="listitem">
Shepard, R. N. (1962a). The analysis of proximities: <span>M</span>ultidimensional scaling with an unknown distance function. <span>I</span>. <em>Psychometrika</em>, <em>27</em>(2), 125–140. https://doi.org/<a href="https://doi.org/10.1007/BF02289630">https://doi.org/10.1007/BF02289630</a>
</div>
<div id="ref-Shepard1962b" class="csl-entry" role="listitem">
Shepard, R. N. (1962b). The analysis of proximities: <span>M</span>ultidimensional scaling with an unknown distance function. <span>II</span>. <em>Psychometrika</em>, <em>27</em>(3), 219–246. https://doi.org/<a href="https://doi.org/10.1007/BF02289621">https://doi.org/10.1007/BF02289621</a>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./accumulator_models.html" class="pagination-link" aria-label="Accumulator models of choice and response time">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Accumulator models of choice and response time</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./vector_reps.html" class="pagination-link" aria-label="Distributed representations, similarity, and recognition">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Distributed representations, similarity, and recognition</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>